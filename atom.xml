<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Fractal128 ï¼š We are OIers]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://blog.fractal128.tk/"/>
  <updated>2015-10-03T06:48:34.000Z</updated>
  <id>http://blog.fractal128.tk/</id>
  
  <author>
    <name><![CDATA[fractal128]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[BZOJ2142: ç¤¼ç‰©]]></title>
    <link href="http://blog.fractal128.tk/2015/10/02/bzoj2142/"/>
    <id>http://blog.fractal128.tk/2015/10/02/bzoj2142/</id>
    <published>2015-10-02T15:51:28.000Z</published>
    <updated>2015-10-03T06:48:34.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸€é“ç»¼åˆå‹æ•°è®ºé¢˜ã€‚ã€‚ã€‚å†™çš„æ…¢ç‚¸äº†ï¼Œ900MSï¼‹<br><a id="more"></a><br>click <a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2142" target="_blank" rel="external">here</a> to solve the problem</p>
<h2 id="Description">Description</h2><p>ä¸€å¹´ä¸€åº¦çš„åœ£è¯èŠ‚å¿«è¦æ¥åˆ°äº†ã€‚æ¯å¹´çš„åœ£è¯èŠ‚å°Eéƒ½ä¼šæ”¶åˆ°è®¸å¤šç¤¼ç‰©ï¼Œå½“ç„¶ä»–ä¹Ÿä¼šé€å‡ºè®¸å¤šç¤¼ç‰©ã€‚ä¸åŒçš„äººç‰©åœ¨å°Eå¿ƒç›®ä¸­çš„é‡è¦æ€§ä¸åŒï¼Œåœ¨å°Eå¿ƒä¸­åˆ†é‡è¶Šé‡çš„äººï¼Œæ”¶åˆ°çš„ç¤¼ç‰©ä¼šè¶Šå¤šã€‚å°Eä»å•†åº—ä¸­è´­ä¹°äº†nä»¶ç¤¼ç‰©ï¼Œæ‰“ç®—é€ç»™mä¸ªäººï¼Œå…¶ä¸­é€ç»™ç¬¬iä¸ªäººç¤¼ç‰©æ•°é‡ä¸ºwiã€‚è¯·ä½ å¸®å¿™è®¡ç®—å‡ºé€ç¤¼ç‰©çš„æ–¹æ¡ˆæ•°ï¼ˆä¸¤ä¸ªæ–¹æ¡ˆè¢«è®¤ä¸ºæ˜¯ä¸åŒçš„ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨æŸä¸ªäººåœ¨è¿™ä¸¤ç§æ–¹æ¡ˆä¸­æ”¶åˆ°çš„ç¤¼ç‰©ä¸åŒï¼‰ã€‚ç”±äºæ–¹æ¡ˆæ•°å¯èƒ½ä¼šå¾ˆå¤§ï¼Œä½ åªéœ€è¦è¾“å‡ºæ¨¡Påçš„ç»“æœã€‚</p>
<h2 id="Solution">Solution</h2><p>åˆ—ä¸€ä¸‹ç»„åˆæ•°çš„å¼å­å¹¶ä¸Šä¸‹çº¦åˆ†å¯ä»¥å¾—åˆ°ç­”æ¡ˆä¸º<br>$$ {n!}\over{w_{1}!*w_{2}!â€¦w_{m}!*(n-w_{1}-w_{2}â€¦-w_{m})!}$$</p>
<p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘Pä¸ºè´¨æ•°æ—¶çš„æƒ…å†µï¼Œå¯å¾—n!åœ¨[1,P-1]åæ˜¯å¾ªç¯çš„ï¼Œä¾¿å¯ä»¥å…ˆç®—å‡º1~P-1æ—¶é˜¶ä¹˜æ¨¡Pçš„å€¼ä¹‹åçº¦å»Pçš„å€æ•°ï¼Œé€’å½’æ±‚è§£å³å¯ã€‚</p>
<p>å¯¹äºPä¸ºåˆæ•°çš„æƒ…å†µï¼Œå°†Påˆ†è§£ï¼Œå°†åœ¨æ¨¡pi^ciçš„ç­”æ¡ˆä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†è¿›è¡Œåˆå¹¶å³å¯ã€‚<br>å…·ä½“é¢˜è§£å¯å‚çœ‹<a href="http://wenku.baidu.com/view/98ac0f93bb68a98271fefaef" target="_blank" rel="external">é­æºçš„å›½å®¶é˜Ÿè®­ç»ƒæŠ¥å‘Š</a></p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll n,P,m,cnt,ans=<span class="number">0</span>,tot=<span class="number">0</span>,sum=<span class="number">0</span>;</span><br><span class="line">ll fac[<span class="number">100010</span>],invfac[<span class="number">100010</span>];</span><br><span class="line">ll a[<span class="number">10</span>],q[<span class="number">10</span>],M[<span class="number">10</span>];</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a, ll b, ll p)</span></span>&#123;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) == <span class="number">1</span>) ret = (ret + a) % p;</span><br><span class="line">        a = (a + a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">pow</span><span class="params">(ll a, ll b, ll p)</span></span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) == <span class="number">1</span>) ret = mul(ret, a, p);</span><br><span class="line">        a = mul(a, a, p);</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;d, ll &amp;x, ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>)&#123;</span><br><span class="line">        x = <span class="number">1</span>; y = <span class="number">0</span>; d = a;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        exgcd(b, a % b, d, y, x); y -= x*(a/b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">get_inv</span><span class="params">(ll a, ll p)</span></span>&#123;</span><br><span class="line">    ll ret,y,d;</span><br><span class="line">    exgcd(a, p, d, ret, y);</span><br><span class="line">    <span class="keyword">return</span> (ret + p) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll x, ll p_i, ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; p_i) <span class="keyword">return</span> fac[x];</span><br><span class="line">    ll seg = x / p; ll res = x % p;</span><br><span class="line">    ll ret = mul(<span class="built_in">pow</span>(fac[p - <span class="number">1</span>], seg, p), fac[res], p);</span><br><span class="line">    cnt += x / p_i;</span><br><span class="line">    <span class="keyword">return</span> mul(ret, calc(x / p_i, p_i, p), p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">invcalc</span><span class="params">(ll x, ll p_i, ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; p_i) <span class="keyword">return</span> invfac[x];</span><br><span class="line">    ll seg = x / p; ll res = x % p;</span><br><span class="line">    ll ret = mul(<span class="built_in">pow</span>(invfac[p - <span class="number">1</span>], seg, p), invfac[res], p);</span><br><span class="line">    cnt -= x / p_i;</span><br><span class="line">    <span class="keyword">return</span> mul(ret, invcalc(x / p_i, p_i, p), p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">sol</span><span class="params">(ll p_i, ll p)</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; p; i++)&#123;</span><br><span class="line">        fac[i] = fac[i-<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (i % p_i != <span class="number">0</span>) fac[i] = mul(fac[i], i, p);</span><br><span class="line">    &#125;</span><br><span class="line">    invfac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; p; i++)&#123;</span><br><span class="line">        invfac[i] = invfac[i-<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (i % p_i != <span class="number">0</span>) invfac[i] = mul(invfac[i], get_inv(i, p), p);</span><br><span class="line">    &#125;</span><br><span class="line">    ll ret = calc(n, p_i, p);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        ret = mul(ret, invcalc(a[i], p_i, p), p);</span><br><span class="line">    &#125;</span><br><span class="line">    ret = mul(ret, invcalc(n - sum, p_i, p), p);</span><br><span class="line">    ret = mul(ret, <span class="built_in">pow</span>(p_i, cnt, p), p);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">CRT</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i++)&#123;</span><br><span class="line">        ll e = P / M[i];</span><br><span class="line">        ans = (ans + <span class="function">e * <span class="title">get_inv</span><span class="params">(e, M[i])</span> * q[i]) % P</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    P = read(); n = read(); m = read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        a[i] = read();</span><br><span class="line">        sum += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum &gt; n)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Impossible"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll tmp = P;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(P); i++)</span><br><span class="line">    <span class="keyword">if</span> (tmp % i==<span class="number">0</span>)&#123;</span><br><span class="line">        ll p = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (tmp % i==<span class="number">0</span>)&#123;</span><br><span class="line">            tmp /= i;</span><br><span class="line">            p *= i;</span><br><span class="line">        &#125;</span><br><span class="line">        q[++tot] = sol(i, p);</span><br><span class="line">        M[tot] = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tmp &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        q[++tot] = sol(tmp, tmp);</span><br><span class="line">        M[tot] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, CRT());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Music">Music</h2><p>å£ç´éƒ¨åˆ†å¾ˆå¥½å¬ã€‚ã€‚ã€‚</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=22782025&auto=1&height=66"></iframe>]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸€é“ç»¼åˆå‹æ•°è®ºé¢˜ã€‚ã€‚ã€‚å†™çš„æ…¢ç‚¸äº†ï¼Œ900MSï¼‹<br>]]>
    
    </summary>
    
      <category term="ä¸­å›½å‰©ä½™å®šç†" scheme="http://blog.fractal128.tk/tags/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/"/>
    
      <category term="ä¹˜æ³•é€†å…ƒ" scheme="http://blog.fractal128.tk/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ2705: [SDOI2012]Longgeçš„é—®é¢˜]]></title>
    <link href="http://blog.fractal128.tk/2015/10/02/bzoj2705/"/>
    <id>http://blog.fractal128.tk/2015/10/02/bzoj2705/</id>
    <published>2015-10-02T05:42:49.000Z</published>
    <updated>2015-10-02T06:05:28.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘éƒ½åªæ˜¯åšä¸€äº›ç®€å•æ•°è®ºæ…¢æ…¢å·©å›ºå§ã€‚<br>æ˜¨æ™šä¸Šè£…<a href="http://www.apple.com/osx/" target="_blank" rel="external">OS X El Capitan</a>äº†ï¼Œæ²¡å¥½å¥½çœ‹ä»‹ç»ä¹Ÿä¸çŸ¥é“å‡çº§äº†äº›ä»€ä¹ˆï¼Œçª˜ã€‚<br><a id="more"></a><br>link:<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2705" target="_blank" rel="external">BZOJ2705: [SDOI2012]Longgeçš„é—®é¢˜</a><br>å¦ï¼šbzojä¸ŠAC50é¢˜ç•™å¿µã€‚</p>
<h2 id="Description">Description</h2><p>Longgeçš„æ•°å­¦æˆç»©éå¸¸å¥½ï¼Œå¹¶ä¸”ä»–éå¸¸ä¹äºæŒ‘æˆ˜é«˜éš¾åº¦çš„æ•°å­¦é—®é¢˜ã€‚ç°åœ¨é—®é¢˜æ¥äº†ï¼šç»™å®šä¸€ä¸ªæ•´æ•°Nï¼Œä½ éœ€è¦æ±‚å‡ºâˆ‘gcd(i, N)(1&lt;=i &lt;=N)ã€‚</p>
<h2 id="Solution">Solution</h2><p>O(âˆšn)æ¬§æ‹‰å‡½æ•°<br>$$ ans=\sum^{d=1}_{d&lt;=n\&amp;d|n}Ï†(d)*{n\over{d}}$$</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> inf <span class="number">100001</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll n,ans=<span class="number">0</span>;</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">phi</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    ll t=x,ret=x;</span><br><span class="line">    <span class="keyword">for</span> (ll i=<span class="number">2</span>; i*i&lt;=x; i++)</span><br><span class="line">    <span class="keyword">if</span> (t % i==<span class="number">0</span>)&#123;</span><br><span class="line">        ret=ret/i*(i-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (t % i==<span class="number">0</span>) t/=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t&gt;<span class="number">1</span>) ret=ret/t*(t-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n = read();</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i*i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span> (n % i == <span class="number">0</span>)&#123;</span><br><span class="line">            ans += <span class="function">i * <span class="title">phi</span><span class="params">(n/i)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (i*i&lt;n) ans += (ll)(n/i) * phi(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans+phi(n)+n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘éƒ½åªæ˜¯åšä¸€äº›ç®€å•æ•°è®ºæ…¢æ…¢å·©å›ºå§ã€‚<br>æ˜¨æ™šä¸Šè£…<a href="http://www.apple.com/osx/">OS X El Capitan</a>äº†ï¼Œæ²¡å¥½å¥½çœ‹ä»‹ç»ä¹Ÿä¸çŸ¥é“å‡çº§äº†äº›ä»€ä¹ˆï¼Œçª˜ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="SDOI" scheme="http://blog.fractal128.tk/tags/SDOI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ3098: Hash Killer II]]></title>
    <link href="http://blog.fractal128.tk/2015/10/02/bzoj3098/"/>
    <id>http://blog.fractal128.tk/2015/10/02/bzoj3098/</id>
    <published>2015-10-01T18:01:17.000Z</published>
    <updated>2015-10-01T18:17:09.000Z</updated>
    <content type="html"><![CDATA[<p>ç¥å¥‡çš„é¢˜ç›®ï¼Œè†œè†œè†œã€‚<br>ä¸€é“é«˜æ‰‹ä¸€çœ‹å°±ä¼šï¼Œè€Œæˆ‘çœ‹äº†é¢˜è§£ä¹Ÿæ²¡ä»€ä¹ˆæƒ³æ³•çš„é¢˜ã€‚<br><a id="more"></a><br><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3098" target="_blank" rel="external">æˆ³å‡º</a>é“¾æ¥</p>
<h2 id="Description">Description</h2><p>è¿™å¤©å¤©æ°”ä¸é”™ï¼Œhzhwcmhfç¥çŠ‡ç»™VFleaKingå‡ºäº†ä¸€é“é¢˜ï¼š<br>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸ºNçš„å­—ç¬¦ä¸²Sï¼Œæ±‚æœ‰å¤šå°‘ä¸ªä¸åŒçš„é•¿åº¦ä¸ºLçš„å­ä¸²ã€‚<br>å­ä¸²çš„å®šä¹‰æ˜¯S[l]ã€S[l + 1]ã€â€¦ S[r]è¿™æ ·è¿ç»­çš„ä¸€æ®µã€‚<br>ä¸¤ä¸ªå­—ç¬¦ä¸²è¢«è®¤ä¸ºæ˜¯ä¸åŒçš„å½“ä¸”ä»…å½“æŸä¸ªä½ç½®ä¸Šçš„å­—ç¬¦ä¸åŒã€‚</p>
<p>VFleaKingä¸€çœ‹è§‰å¾—è¿™ä¸æ˜¯Hashçš„è£¸é¢˜ä¹ˆï¼äºæ˜¯æœæ–­å†™äº†å“ˆå¸Œ + æ’åºã€‚<br>è€Œhzhwcmhfç¥çŠ‡å¿ƒé‡Œè‡ªç„¶çŸ¥é“ï¼Œè¿™é¢˜å°±æ˜¯åç¼€æ•°ç»„çš„heightä¸­ &lt; Lçš„ä¸ªæ•° + 1ï¼Œå°±æ˜¯åç¼€è‡ªåŠ¨æœºä¸Šä»£è¡¨çš„é•¿åº¦åŒºé—´åŒ…å«Lçš„ç»“ç‚¹ä¸ªæ•°ï¼Œå°±æ˜¯åç¼€æ ‘æ·±åº¦ä¸ºLçš„ç»“ç‚¹çš„æ•°é‡ã€‚<br>ä½†æ˜¯hzhwcmhfç¥çŠ‡çœ‹äº†çœ‹VFleaKingçš„åšæ³•è¡¨ç¤ºéå¸¸æ±—ã€‚äºæ˜¯æƒ³å¡æ‰ä»–ã€‚</p>
<p>VFleaKingä½¿ç”¨çš„æ˜¯å­—å…¸åºå“ˆå¸Œï¼Œå…¶ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š<br>u64 val = 0;<br>for (int i = 0; i &lt; l; i++)<br> val = (val * base + s[i] - â€˜aâ€™) % Mod;<br>u64æ˜¯æ— ç¬¦å·int64ï¼ŒèŒƒå›´æ˜¯[0, 2^64)ã€‚<br>baseæ˜¯ä¸€ä¸ªå¸¸é‡ï¼ŒVFleaKingä¼šæ ¹æ®å¿ƒæƒ…å†³å®šå…¶å€¼ã€‚<br>Modç­‰äº1000000007ã€‚<br>VFleaKingè¿˜æ±‚å‡ºæ¥äº†base ^ l % Modï¼Œå³baseçš„læ¬¡æ–¹é™¤ä»¥Modçš„ä½™æ•°ï¼Œè¿™æ ·å°±èƒ½æ–¹ä¾¿åœ°æ±‚å‡ºæ‰€æœ‰é•¿åº¦ä¸ºLçš„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚<br>ç„¶åVFleaKingç»™å“ˆå¸Œå€¼æ’åºï¼Œå»é‡ï¼Œæ±‚å‡ºæœ‰å¤šå°‘ä¸ªä¸åŒçš„å“ˆå¸Œå€¼ï¼ŒæŠŠè¿™ä¸ªæ•°ä½œä¸ºç»“æœã€‚<br>å…¶ç®—æ³•çš„C++ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> u64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxN = <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">hash_handle</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">int</span> &amp;n, <span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;base)</span></span><br><span class="line"></span>&#123;</span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">int</span> Mod = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"> u64 hash_pow_l = <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; i++)</span><br><span class="line">  hash_pow_l = (hash_pow_l * base) % Mod;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">int</span> li_n = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">int</span> li[MaxN];</span><br><span class="line"></span><br><span class="line"> u64 val = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++)</span><br><span class="line">  val = (val * base + s[i] - <span class="string">'a'</span>) % Mod;</span><br><span class="line"> li[li_n++] = val;</span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; n; i++)</span><br><span class="line"> &#123;</span><br><span class="line">  val = (val * base + s[i] - <span class="string">'a'</span>) % Mod;</span><br><span class="line">  val = (val + Mod - ((s[i - l] - <span class="string">'a'</span>) * hash_pow_l) % Mod) % Mod;</span><br><span class="line">  li[li_n++] = val;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> sort(li, li + li_n);</span><br><span class="line"> li_n = unique(li, li + li_n) - li;</span><br><span class="line"> <span class="keyword">return</span> li_n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>hzhwcmhfå½“ç„¶çŸ¥é“æ€ä¹ˆå¡å•¦ï¼ä½†æ˜¯ä»–æƒ³è€ƒè€ƒä½ ã€‚</p>
<h2 id="Solution">Solution</h2><p>çœ‹äº†å¾ˆä¹…æ‰ç¨å¾®æœ‰ç‚¹æ˜ç™½ã€‚<br>æŠŠæ¯ä¸€æ¬¡è®¡ç®—hashå½“æˆæ˜¯éšæœºæ•°ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ç”Ÿæ—¥æ‚–è®ºçš„æ€§è´¨ï¼ˆåœ¨pollard-rhoä¸­ä¹Ÿæ˜¯è¿™ä¸ªæ€§è´¨ï¼‰ï¼Œæ‰€ä»¥å¤§æ¦‚å°±æ˜¯æŠŠnå»åˆ°ä¸ª100000ï¼Œç„¶åä¹±æå°±è¡Œäº†ã€‚<br>æ³¨æ„lè¦ç¨å¾®å»å¤§ä¸€ç‚¹ï¼Œä¸ç„¶çš„è¯ç®—å‡ºçš„hashå€¼å°±ä¸æ˜¯é‚£ä¹ˆéšæœºäº†ã€‚ã€‚ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n=<span class="number">100000</span>,l=<span class="number">30</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;n&lt;&lt;<span class="string">' '</span>&lt;&lt;l&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="keyword">char</span>(rand()%<span class="number">26</span>+<span class="string">'a'</span>);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¥å¥‡çš„é¢˜ç›®ï¼Œè†œè†œè†œã€‚<br>ä¸€é“é«˜æ‰‹ä¸€çœ‹å°±ä¼šï¼Œè€Œæˆ‘çœ‹äº†é¢˜è§£ä¹Ÿæ²¡ä»€ä¹ˆæƒ³æ³•çš„é¢˜ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ4291: [PA2015]Kieszonkowe]]></title>
    <link href="http://blog.fractal128.tk/2015/10/01/bzoj4291/"/>
    <id>http://blog.fractal128.tk/2015/10/01/bzoj4291/</id>
    <published>2015-10-01T14:40:02.000Z</published>
    <updated>2015-10-01T18:19:48.000Z</updated>
    <content type="html"><![CDATA[<p>åˆ·æ°´é¢˜ï¼Œä¿å¹³å®‰ã€‚fractalå¦‚æ˜¯è¯´ã€‚<br><a id="more"></a><br>ç»™<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=4291" target="_blank" rel="external">é“¾æ¥</a><br>å¦:æˆ‘å¥½å–œæ¬¢è¿™å¼ å›¾å•Šã€‚</p>
<h2 id="Description">Description</h2><p>ç»™å®šnä¸ªæ•°ï¼Œè¯·ä»ä¸­é€‰å‡ºè‹¥å¹²ä¸ªæ•°ï¼Œä½¿å¾—æ€»å’Œä¸ºå¶æ•°ï¼Œè¯·æœ€å¤§åŒ–è¿™ä¸ªæ€»å’Œã€‚</p>
<h2 id="Solution">Solution</h2><p>æ€ä¹ˆåšéƒ½å¯ä»¥å§ã€‚ã€‚ã€‚<br>ä½†è¿˜æ˜¯å¾ˆå¼€å¿ƒä»£ç æ¯”jcvbå¿«çš„ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> inf <span class="number">100001</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll n,sum=<span class="number">0</span>,mi=inf;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n=read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x; x=read();</span><br><span class="line">        sum+=x;</span><br><span class="line">        <span class="keyword">if</span> ((x % <span class="number">2</span>==<span class="number">1</span>)&amp;&amp;x&lt;mi) mi=x; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum % <span class="number">2</span>==<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,sum); <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span> (mi!=sum) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, sum-mi); <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"NIESTETY\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>åˆ·æ°´é¢˜ï¼Œä¿å¹³å®‰ã€‚fractalå¦‚æ˜¯è¯´ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ°´é¢˜" scheme="http://blog.fractal128.tk/categories/OI/%E6%B0%B4%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ2190: [SDOI2008]ä»ªä»—é˜Ÿ]]></title>
    <link href="http://blog.fractal128.tk/2015/10/01/bzoj2190/"/>
    <id>http://blog.fractal128.tk/2015/10/01/bzoj2190/</id>
    <published>2015-10-01T07:42:09.000Z</published>
    <updated>2015-10-01T07:54:22.000Z</updated>
    <content type="html"><![CDATA[<p>çº¿æ€§ç­›è®¡ç®—æ¬§æ‹‰å‡½æ•°æ¨¡æ¿ã€‚<br><a id="more"></a></p>
<p>é¢˜ç›®é“¾æ¥<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2190" target="_blank" rel="external">åœ¨æ­¤</a></p>
<h2 id="Description">Description</h2><p>ä½œä¸ºä½“è‚²å§”å‘˜ï¼ŒCå›è´Ÿè´£è¿™æ¬¡è¿åŠ¨ä¼šä»ªä»—é˜Ÿçš„è®­ç»ƒã€‚ä»ªä»—é˜Ÿæ˜¯ç”±å­¦ç”Ÿç»„æˆçš„N * Nçš„æ–¹é˜µï¼Œä¸ºäº†ä¿è¯é˜Ÿä¼åœ¨è¡Œè¿›ä¸­æ•´é½åˆ’ä¸€ï¼ŒCå›ä¼šè·Ÿåœ¨ä»ªä»—é˜Ÿçš„å·¦åæ–¹ï¼Œæ ¹æ®å…¶è§†çº¿æ‰€åŠçš„å­¦ç”Ÿäººæ•°æ¥åˆ¤æ–­é˜Ÿä¼æ˜¯å¦æ•´é½ã€‚<br>ç°åœ¨ï¼ŒCå›å¸Œæœ›ä½ å‘Šè¯‰ä»–é˜Ÿä¼æ•´é½æ—¶èƒ½çœ‹åˆ°çš„å­¦ç”Ÿäººæ•°ã€‚<br><img src="http://7xl5lt.com1.z0.glb.clouddn.com/2190.jpg.gif" alt="2190"></p>
<h2 id="Solution">Solution</h2><p>å°†å›¾æ²¿å¯¹è§’çº¿åˆ†å¼€ï¼Œå¯ä»¥å¾—åˆ°ç­”æ¡ˆå…¬å¼:<br>$$ ans=2\cdot\sum^{i=2}_{i&lt;n}{Ï†(i)}+3$$<br>ç”¨çº¿æ€§ç­›æ±‚å„æ•°çš„æ¬§æ‹‰å‡½æ•°å³å¯ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">1000000</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">ll vis[maxn],phi[maxn],p[maxn];</span><br><span class="line"><span class="keyword">int</span> tot,n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>) &#123; x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_phi</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] == <span class="number">0</span>)&#123;</span><br><span class="line">            vis[i] = <span class="number">1</span>; p[++tot] = i;</span><br><span class="line">            phi[i] = i-<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j &lt;= tot; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i*p[j]&gt;n) <span class="keyword">break</span>;</span><br><span class="line">            vis[i*p[j]]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)&#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * (p[j]-<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n = read();</span><br><span class="line">    get_phi();</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n-<span class="number">1</span>; i ++)&#123;</span><br><span class="line">        sum+=phi[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>,sum * <span class="number">2</span> + <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>çº¿æ€§ç­›è®¡ç®—æ¬§æ‹‰å‡½æ•°æ¨¡æ¿ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="SDOI" scheme="http://blog.fractal128.tk/tags/SDOI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åˆç­‰æ•°è®ºï¼ˆä¸‰ï¼‰]]></title>
    <link href="http://blog.fractal128.tk/2015/10/01/number-theory3/"/>
    <id>http://blog.fractal128.tk/2015/10/01/number-theory3/</id>
    <published>2015-09-30T17:16:35.000Z</published>
    <updated>2015-09-30T17:48:58.000Z</updated>
    <content type="html"><![CDATA[<p>æ•°è®ºå¥½éš¾å•Šã€‚ã€‚ã€‚<br><a id="more"></a></p>
<h1 id="åˆç­‰æ•°è®º">åˆç­‰æ•°è®º</h1><h2 id="ç§¯æ€§å‡½æ•°">ç§¯æ€§å‡½æ•°</h2><p>åœ¨éæ•°è®ºçš„é¢†åŸŸï¼Œç§¯æ€§å‡½æ•°æŒ‡æ‰€æœ‰å¯¹äºä»»ä½•a,béƒ½æœ‰æ€§è´¨f(ab)=f(a)f(b)çš„å‡½æ•°ã€‚<br>åœ¨æ•°è®ºä¸­çš„ç§¯æ€§å‡½æ•°ï¼šå¯¹äºæ­£æ•´æ•°nçš„ä¸€ä¸ªç®—æœ¯å‡½æ•° f(n)ï¼Œè‹¥f(1)=1ï¼Œä¸”å½“a,bäº’è´¨æ—¶f(ab)=f(a)f(b)ï¼Œåœ¨æ•°è®ºä¸Šå°±ç§°å®ƒä¸ºç§¯æ€§å‡½æ•°ã€‚è‹¥å¯¹äºæŸç§¯æ€§å‡½æ•° f(n) ï¼Œå°±ç®—a, bä¸äº’è´¨ï¼Œä¹Ÿæœ‰f(ab)=f(a)f(b)ï¼Œåˆ™ç§°å®ƒä¸ºå®Œå…¨ç§¯æ€§çš„ã€‚</p>
<p>åˆ—äº†ä¸€å †å¥‡æ€ªçš„å‡½æ•°ã€‚ã€‚ã€‚</p>
<blockquote>
<ul>
<li>Ï†(n) ï¼æ¬§æ‹‰å‡½æ•°ï¼Œè®¡ç®—ä¸näº’è´¨çš„æ­£æ•´æ•°ä¹‹æ•°ç›®</li>
<li>Î¼(n) ï¼è«æ¯”ä¹Œæ–¯å‡½æ•°ï¼Œå…³äºéå¹³æ–¹æ•°çš„è´¨å› å­æ•°ç›®</li>
<li>gcd(n,k) ï¼æœ€å¤§å…¬å› å­ï¼Œå½“kå›ºå®šçš„æƒ…å†µ</li>
<li>d(n) ï¼nçš„æ­£å› å­æ•°ç›®</li>
<li>Ïƒ(n) ï¼nçš„æ‰€æœ‰æ­£å› å­ä¹‹å’Œ</li>
<li>Ïƒk(n) ï¼ å› å­å‡½æ•°ï¼Œnçš„æ‰€æœ‰æ­£å› å­çš„kæ¬¡å¹‚ä¹‹å’Œï¼Œå½“ä¸­kå¯ä¸ºä»»ä½•å¤æ•°ã€‚</li>
<li>1(n) ï¼ä¸å˜çš„å‡½æ•°ï¼Œå®šä¹‰ä¸º 1(n) = 1 ï¼ˆå®Œå…¨ç§¯æ€§ï¼‰</li>
<li>Id(n) ï¼å•ä½å‡½æ•°ï¼Œå®šä¹‰ä¸º Id(n) = nï¼ˆå®Œå…¨ç§¯æ€§ï¼‰</li>
<li>Idk(n) ï¼å¹‚å‡½æ•°ï¼Œå¯¹äºä»»ä½•å¤æ•°ã€å®æ•°kï¼Œå®šä¹‰ä¸ºIdk(n) = n^k ï¼ˆå®Œå…¨ç§¯æ€§ï¼‰</li>
<li>Îµ(n) ï¼å®šä¹‰ä¸ºï¼šè‹¥n = 1ï¼ŒÎµ(n)=1ï¼›è‹¥ n &gt; 1ï¼ŒÎµ(n)=0ã€‚åˆ«ç§°ä¸ºâ€œå¯¹äºç‹„åˆ©å…‹é›·å·ç§¯çš„ä¹˜æ³•å•ä½â€ï¼ˆå®Œå…¨ç§¯æ€§ï¼‰</li>
<li>Î»(n) ï¼åˆ˜ç»´å°”å‡½æ•°ï¼Œå…³äºèƒ½æ•´é™¤nçš„è´¨å› å­çš„æ•°ç›®</li>
<li>Î³(n)ï¼Œå®šä¹‰ä¸ºÎ³(n)=(-1)^Ï‰(n)ï¼Œåœ¨æ­¤åŠ æ€§å‡½æ•°Ï‰(n)æ˜¯ä¸åŒèƒ½æ•´é™¤nçš„è´¨æ•°çš„æ•°ç›®</li>
</ul>
</blockquote>
<p>å¦å¤–ï¼Œæ‰€æœ‰ç‹„åˆ©å…‹é›·ç‰¹å¾å‡æ˜¯å®Œå…¨ç§¯æ€§çš„</p>
<h2 id="æ¬§æ‹‰å‡½æ•°">æ¬§æ‹‰å‡½æ•°</h2><p>åœ¨æ•°è®ºï¼Œå¯¹æ­£æ•´æ•°nï¼Œæ¬§æ‹‰å‡½æ•°æ˜¯å°‘äºæˆ–ç­‰äºnçš„æ•°ä¸­ä¸näº’è´¨çš„æ•°çš„æ•°ç›®ã€‚æ­¤å‡½æ•°ä»¥å…¶é¦–åç ”ç©¶è€…æ¬§æ‹‰å‘½åï¼Œå®ƒåˆç§°ä¸ºEulerâ€™s totient functionã€Ï†å‡½æ•°ã€æ¬§æ‹‰å•†æ•°ç­‰ã€‚ ä¾‹å¦‚Ï†(8)=4ï¼Œå› ä¸º1,3,5,7å‡å’Œ8äº’è´¨ã€‚ ä»æ¬§æ‹‰å‡½æ•°å¼•ä¼¸å‡ºæ¥åœ¨ç¯è®ºæ–¹é¢çš„äº‹å®å’Œæ‹‰æ ¼æœ—æ—¥å®šç†æ„æˆäº†æ¬§æ‹‰å®šç†çš„è¯æ˜ã€‚</p>
<h3 id="å…¬å¼">å…¬å¼</h3><p>$$ Ï†(x)=x\cdot\prod( 1-{1\over{p_i}}) $$</p>
<h3 id="å®ç°">å®ç°</h3><p>ç”±äºå…¶ç§¯æ€§å‡½æ•°çš„æ€§è´¨ï¼Œå¯ä»¥å¾ˆå¥½çš„åœ¨çº¿æ€§ç­›ä¸­å®ç°ã€‚</p>
<h2 id="ä¹˜æ³•é€†å…ƒ">ä¹˜æ³•é€†å…ƒ</h2><p>aaâ€™=aâ€™a=e</p>
<p>è´¨æ•°ï¼šè´¹é©¬å°å®šç†+å¿«é€Ÿå¹‚<br>ä»»æ„æ•°ï¼šExgcd</p>
<h2 id="ä¸­å›½å‰©ä½™å®šç†">ä¸­å›½å‰©ä½™å®šç†</h2><p>å·²çŸ¥Xé™¤ä»¥è‹¥å¹²æ•°çš„ä½™æ•°ï¼Œæ±‚Xçš„è§£é›†</p>
<p>æ„é€ æ³•:<br>xâ‰¡A (mod N)  ä¸”  xâ‰¡B (mod M)<br>è‹¥A%gcd(N,M)â‰ B%gcd(N,M)æ— è§£<br>å¦åˆ™<br>ans=(A*M*ni(M,N)+B*N*ni(N,M))+k*lcm(N,M)</p>
<p>æ¨¡éè´¨æ•°Pæ—¶å…ˆåšè´¨å› æ•°åˆ†è§£ï¼Œåœ¨å„ä¸ªæ¨¡ä¸‹æ±‚è§£åœ¨ä¸­å›½å‰©ä½™å®šç†åˆå¹¶</p>
<h2 id="é˜¶">é˜¶</h2><p>è®¾aï¼Œpæ˜¯æ•´æ•°ï¼Œæœ‰ï¼ša^nâ‰¡1 (mod p)<br>å¯ä»¥ä½¿ä¸Šå¼æˆç«‹çš„æœ€å°æ­£æ•´æ•°nå«åšaæ¨¡pçš„é˜¶ã€‚</p>
<h2 id="åŸæ ¹ä¸æŒ‡æ ‡">åŸæ ¹ä¸æŒ‡æ ‡</h2><p>xk mod n å¯¹äºk&lt;Ï†(n)äº’ä¸ç›¸åŒï¼Œxæ˜¯æ¨¡nçš„åŸæ ¹<br>ç¦»æ•£å¯¹æ•°ï¼šabâ‰¡c (mod n)  â†’  indac=b (mod Ï†(n))<br>abâ‰¡c (mod n)  â†’  b*indpa=indpc (mod Ï†(n))<br>å­˜åœ¨åŸæ ¹çš„æ•°ï¼š2,4,pa,2pa(pæ˜¯ç´ æ•°)  </p>]]></content>
    <summary type="html">
    <![CDATA[<p>æ•°è®ºå¥½éš¾å•Šã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æ‘‡æ›³çš„ä¹æœˆã€‚]]></title>
    <link href="http://blog.fractal128.tk/2015/09/30/201509/"/>
    <id>http://blog.fractal128.tk/2015/09/30/201509/</id>
    <published>2015-09-30T13:24:53.000Z</published>
    <updated>2015-09-30T14:00:52.000Z</updated>
    <content type="html"><![CDATA[<p>Sept. 30<br><a id="more"></a><br>ä¹æœˆå¿«è¿‡äº†ã€‚æ˜¯æ—¶å€™å†™çš„ä»€ä¹ˆæ€»ç»“ä»€ä¹ˆçš„äº†ã€‚ã€‚ã€‚</p>
<ul>
<li><p>yå°å§å»Germanyäº†ï¼Œæ„Ÿè§‰ç­é‡Œå°‘äº†ç‚¹ä»¥å‰æ—©å·²æˆä¸ºä¹ æƒ¯çš„ä¸œè¥¿ã€‚ã€‚ã€‚çœ‹äº†å¥¹å†™çš„åšæ–‡ï¼Œæ˜¯æœ‰ç‚¹å°æ„ŸåŠ¨ã€‚<a href="http://user.qzone.qq.com/814218105" target="_blank" rel="external">ğŸ”—</a></p>
</li>
<li><p>mscå»åŒ—äº¬äº†ï¼ŒèƒŒç€æˆ‘ä»¬ï¼Œå¤§æ¦‚æ˜¯è¦å»è¯»ä¸­å…³æ‘æ–‡ç†å­¦é™¢äº†ã€‚</p>
</li>
<li><p>fjå»ç™½é©¬æ¹–äº†ï¼Œå‰©ä¸‹å‡ ä¸ªä¸çŸ¥é“è¯¥æ€ä¹ˆåŠçš„OIersï¼Œè¿æ¥äº†æ–°çš„ä¸€ä¸ªäººå’Œä¸€ä¸ªæ–°çš„OJï¼Œé«˜ä¸€å¼ºå¾—çˆ†ç‚¸ï¼ŒåšæŒåˆ«é€€é˜Ÿæœ€è¦ç´§ã€‚ã€‚ã€‚</p>
</li>
<li><p>é©¬ä¸Šçš„è€ƒè¯•ï¼šå„ç§å­¦è€ƒï¼Œä»¥åŠNOIPï¼Œä¹Ÿä¸çŸ¥é“Wenè¿˜æä¸æä¿¡å¥¥ã€‚</p>
</li>
</ul>
<p>è¿™å°±æ˜¯ä¹æœˆï¼Œçº ç»“ä¸ªä¸åœï¼Œä½†è¿˜æ˜¯å¾ˆå¼€å¿ƒå’ŒåŒå­¦ä»¬ä¸€èµ·çš„ï¼Œåº¦è¿‡è¿™ä¸ªæ‘‡æ›³çš„ä¹æœˆã€‚</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=108164&auto=1&height=66"></iframe>]]></content>
    <summary type="html">
    <![CDATA[<p>Sept. 30<br>]]>
    
    </summary>
    
      <category term="éšè®°" scheme="http://blog.fractal128.tk/categories/%E9%9A%8F%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åˆç­‰æ•°è®ºï¼ˆäºŒï¼‰]]></title>
    <link href="http://blog.fractal128.tk/2015/09/27/number-theory2/"/>
    <id>http://blog.fractal128.tk/2015/09/27/number-theory2/</id>
    <published>2015-09-27T07:11:45.000Z</published>
    <updated>2015-09-30T17:19:37.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸­ç§‹å¿«ä¹ï¼<br>ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚<br><a id="more"></a></p>
<h1 id="åˆç­‰æ•°è®º">åˆç­‰æ•°è®º</h1><h2 id="æ•°è®ºç­›æ³•">æ•°è®ºç­›æ³•</h2><h3 id="Eraosthensç­›æ³•">Eraosthensç­›æ³•</h3><p>åŸºæœ¬ç­›æ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¸ä¼šè¢«å¡ï¼Œæ—¶é—´å¤æ‚åº¦Î˜(nlogn)[æˆ‘ä¸ä¼šç®—ã€‚ã€‚ã€‚</p>
<h3 id="çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)">çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)</h3><p>æ—¶é—´å¤æ‚åº¦Î˜(n)[è¿˜æ˜¯ä¸ä¼šç®—ã€‚ã€‚ã€‚<br>ç›´æ¥æ”¾ä»£ç ã€‚ã€‚ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=i;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!mindiv[i])prime[++tot]=mindiv[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=tot&amp;&amp;prime[j]&lt;=mindiv[i]&amp;&amp;(k=prime[j]*i)&lt;=n;j++)</span><br><span class="line">    mindiv[k]=prime[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//mindiv[k]è¡¨ç¤ºkçš„æœ€å°è´¨å› æ•°ï¼Œè¿™æ ·ä¿è¯äº†æ¯ä¸€ä¸ªæ•°åªä¼šè¢«ä»–çš„æœ€å°è´¨å› æ•°ç­›æ‰ä¸€éã€‚</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å¸¸ç”¨æ€§è´¨">å¸¸ç”¨æ€§è´¨</h3><p>nä»¥å†…ç´ æ•°ä¸ªæ•°O(n/ln(n))</p>
<h2 id="ç´ æ•°æµ‹è¯•">ç´ æ•°æµ‹è¯•</h2><h3 id="Fermatç´ æ•°æµ‹è¯•">Fermatç´ æ•°æµ‹è¯•</h3><h4 id="è´¹é©¬å°å®šç†">è´¹é©¬å°å®šç†</h4><blockquote>
<p>å¯¹äºç´ æ•°pä¸ä»»æ„ä¸päº’ç´ çš„æ•´æ•°aæ»¡è¶³a(p-1) â‰¡1(mod p)</p>
</blockquote>
<h4 id="è¯æ˜">è¯æ˜</h4><blockquote><p>è¿™ä¸ªè¯æ˜å°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚<br>    é¦–å…ˆæˆ‘ä»¬è¯æ˜è¿™æ ·ä¸€ä¸ªç»“è®ºï¼šå¦‚æœpæ˜¯ä¸€ä¸ªç´ æ•°çš„è¯ï¼Œé‚£ä¹ˆå¯¹ä»»æ„ä¸€ä¸ªå°äºpçš„æ­£æ•´æ•°aï¼Œa, 2a, 3a, â€¦, (p-1)aé™¤ä»¥pçš„ä½™æ•°æ­£å¥½æ˜¯ä¸€ä¸ª1åˆ°p-1çš„æ’åˆ—ã€‚ä¾‹å¦‚ï¼Œ5æ˜¯ç´ æ•°ï¼Œ3, 6, 9, 12é™¤ä»¥5çš„ä½™æ•°åˆ†åˆ«ä¸º3, 1, 4, 2ï¼Œæ­£å¥½å°±æ˜¯1åˆ°4è¿™å››ä¸ªæ•°ã€‚<br>    åè¯æ³•ï¼Œå‡å¦‚ç»“è®ºä¸æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯è¯´æœ‰ä¸¤ä¸ªå°äºpçš„æ­£æ•´æ•°må’Œnä½¿å¾—naå’Œmaé™¤ä»¥pçš„ä½™æ•°ç›¸åŒã€‚ä¸å¦¨å‡è®¾n&gt;mï¼Œåˆ™på¯ä»¥æ•´é™¤a(n-m)ã€‚ä½†pæ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆaå’Œn-mä¸­è‡³å°‘æœ‰ä¸€ä¸ªå«æœ‰å› å­pã€‚è¿™æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºaå’Œn-méƒ½æ¯”på°ã€‚<br>    ç”¨åŒä½™å¼è¡¨è¿°ï¼Œæˆ‘ä»¬è¯æ˜äº†ï¼š<br>(p-1)! â‰¡ a * 2a * 3a * â€¦ * (p-1)a (mod p)<br>    ä¹Ÿå³ï¼š<br>(p-1)! â‰¡ (p-1)! * a^(p-1) (mod p)<br>    ä¸¤è¾¹åŒæ—¶é™¤ä»¥(p-1)!ï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬çš„æœ€ç»ˆç»“è®ºï¼š<br>1 â‰¡ a^(p-1) (mod p)</p><footer><strong>Matrix67</strong><cite><a href="http://www.matrix67.com/blog/archives/234" target="_blank" rel="external">æ•°è®ºéƒ¨åˆ†ç¬¬ä¸€èŠ‚ï¼šç´ æ•°ä¸ç´ æ€§æµ‹è¯•</a></cite></footer></blockquote>
<h4 id="é™åˆ¶ä¸ä¼ªç´ æ•°">é™åˆ¶ä¸ä¼ªç´ æ•°</h4><blockquote><p>è°ˆåˆ°Fermatå°å®šç†ï¼Œæ•°å­¦å†å²ä¸Šæœ‰å¾ˆå¤šè¯¯è§£ã€‚å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œäººä»¬éƒ½è®¤ä¸ºFermatå°å®šç†çš„é€†å‘½é¢˜æ˜¯æ­£ç¡®çš„ï¼Œå¹¶ä¸”æœ‰äººäº²è‡ªéªŒè¯äº†a=2, p&lt;300çš„æ‰€æœ‰æƒ…å†µã€‚å›½å¤–ç”šè‡³æµä¼ ç€ä¸€ç§è¯´æ³•ï¼Œè®¤ä¸ºä¸­å›½åœ¨å­”å­æ—¶ä»£å°±è¯æ˜äº†è¿™æ ·çš„å®šç†ï¼šå¦‚æœnæ•´é™¤2^(n-1)-1ï¼Œåˆ™nå°±æ˜¯ç´ æ•°ã€‚åæ¥æŸä¸ªè‹±å›½å­¦è€…è¿›è¡Œè€ƒè¯åæ‰å‘ç°é‚£æ˜¯å› ä¸ºä»–ä»¬ç¿»è¯‘ä¸­å›½å¤æ–‡æ—¶å‡ºäº†é”™ã€‚1819å¹´æœ‰äººå‘ç°äº†Fermatå°å®šç†é€†å‘½é¢˜çš„ç¬¬ä¸€ä¸ªåä¾‹ï¼šè™½ç„¶2çš„340æ¬¡æ–¹é™¤ä»¥341ä½™1ï¼Œä½†341=11*31ã€‚åæ¥ï¼Œäººä»¬åˆå‘ç°äº†561, 645, 1105ç­‰æ•°éƒ½è¡¨æ˜a=2æ—¶Fermatå°å®šç†çš„é€†å‘½é¢˜ä¸æˆç«‹ã€‚è™½ç„¶è¿™æ ·çš„æ•°ä¸å¤šï¼Œä½†ä¸èƒ½å¿½è§†å®ƒä»¬çš„å­˜åœ¨ã€‚äºæ˜¯ï¼Œäººä»¬æŠŠæ‰€æœ‰èƒ½æ•´é™¤2^(n-1)-1çš„åˆæ•°nå«åšä¼ªç´ æ•°(pseudoprime)ï¼Œæ„æ€å°±æ˜¯å‘Šè¯‰äººä»¬è¿™ä¸ªç´ æ•°æ˜¯å‡çš„ã€‚</p>
<p>ä¸æ»¡è¶³2^(n-1) mod n = 1çš„nä¸€å®šä¸æ˜¯ç´ æ•°ï¼›å¦‚æœæ»¡è¶³çš„è¯åˆ™å¤šåŠæ˜¯ç´ æ•°ã€‚è¿™æ ·ï¼Œä¸€ä¸ªæ¯”è¯•é™¤æ³•æ•ˆç‡æ›´é«˜çš„ç´ æ€§åˆ¤æ–­æ–¹æ³•å‡ºç°äº†ï¼šåˆ¶ä½œä¸€å¼ ä¼ªç´ æ•°è¡¨ï¼Œè®°å½•æŸä¸ªèŒƒå›´å†…çš„æ‰€æœ‰ä¼ªç´ æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰æ»¡è¶³2^(n-1) mod n = 1ä¸”ä¸åœ¨ä¼ªç´ æ•°è¡¨ä¸­çš„nå°±æ˜¯ç´ æ•°ã€‚ä¹‹æ‰€ä»¥è¿™ç§æ–¹æ³•æ›´å¿«ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•å¿«é€Ÿè®¡ç®—2^(n-1) mod n çš„å€¼ï¼Œè¿™åœ¨è®¡ç®—æœºçš„å¸®åŠ©ä¸‹å˜å¾—éå¸¸å®¹æ˜“ï¼›åœ¨è®¡ç®—æœºä¸­ä¹Ÿå¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾æœ‰åºæ•°åˆ—ã€Hashè¡¨å¼€æ•£åˆ—ã€æ„å»ºTrieæ ‘ç­‰æ–¹æ³•ä½¿å¾—æŸ¥æ‰¾ä¼ªç´ æ•°è¡¨æ•ˆç‡æ›´é«˜ã€‚</p>
<p>æœ‰äººè‡ªç„¶ä¼šå…³å¿ƒè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¼ªç´ æ•°çš„ä¸ªæ•°åˆ°åº•æœ‰å¤šå°‘ï¼Ÿæ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘åªè®¡ç®—2^(n-1) mod nçš„å€¼ï¼Œäº‹å…ˆä¸å‡†å¤‡ä¼ªç´ æ•°è¡¨ï¼Œé‚£ä¹ˆç´ æ€§åˆ¤æ–­å‡ºé”™çš„æ¦‚ç‡æœ‰å¤šå°‘ï¼Ÿç ”ç©¶è¿™ä¸ªé—®é¢˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯OIerï¼Œä¸å¯èƒ½èƒŒä¸€ä¸ªé•¿åº¦ä¸Šåƒçš„å¸¸é‡æ•°ç»„å¸¦ä¸Šè€ƒåœºã€‚ç»Ÿè®¡è¡¨æ˜ï¼Œåœ¨å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­å…±æœ‰50847534ä¸ªç´ æ•°ï¼Œè€Œæ»¡è¶³2^(n-1) mod n = 1çš„åˆæ•°næœ‰5597ä¸ªã€‚è¿™æ ·ç®—ä¸‹æ¥ï¼Œç®—æ³•å‡ºé”™çš„å¯èƒ½æ€§çº¦ä¸º0.00011ã€‚è¿™ä¸ªæ¦‚ç‡å¤ªé«˜äº†ï¼Œå¦‚æœæƒ³å…å»å»ºç«‹ä¼ªç´ æ•°è¡¨çš„å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦æ”¹è¿›ç´ æ€§åˆ¤æ–­çš„ç®—æ³•ã€‚  </p>
<p>æœ€ç®€å•çš„æƒ³æ³•å°±æ˜¯ï¼Œæˆ‘ä»¬åˆšæ‰åªè€ƒè™‘äº†a=2çš„æƒ…å†µã€‚å¯¹äºå¼å­a^(n-1) mod nï¼Œå–ä¸åŒçš„aå¯èƒ½å¯¼è‡´ä¸åŒçš„ç»“æœã€‚ä¸€ä¸ªåˆæ•°å¯èƒ½åœ¨a=2æ—¶é€šè¿‡äº†æµ‹è¯•ï¼Œä½†a=3æ—¶çš„è®¡ç®—ç»“æœå´æ’é™¤äº†ç´ æ•°çš„å¯èƒ½ã€‚äºæ˜¯ï¼Œäººä»¬æ‰©å±•äº†ä¼ªç´ æ•°çš„å®šä¹‰ï¼Œç§°æ»¡è¶³a^(n-1) mod n = 1çš„åˆæ•°nå«åšä»¥aä¸ºåº•çš„ä¼ªç´ æ•°(pseudoprime to base a)ã€‚å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­åŒæ—¶ä»¥2å’Œ3ä¸ºåº•çš„ä¼ªç´ æ•°åªæœ‰1272ä¸ªï¼Œè¿™ä¸ªæ•°ç›®ä¸åˆ°åˆšæ‰çš„1/4ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬å¦‚æœåŒæ—¶éªŒè¯a=2å’Œa=3ä¸¤ç§æƒ…å†µï¼Œç®—æ³•å‡ºé”™çš„æ¦‚ç‡é™åˆ°äº†0.000025ã€‚å®¹æ˜“æƒ³åˆ°ï¼Œé€‰æ‹©ç”¨æ¥æµ‹è¯•çš„aè¶Šå¤šï¼Œç®—æ³•è¶Šå‡†ç¡®ã€‚é€šå¸¸æˆ‘ä»¬çš„åšæ³•æ˜¯ï¼Œéšæœºé€‰æ‹©è‹¥å¹²ä¸ªå°äºå¾…æµ‹æ•°çš„æ­£æ•´æ•°ä½œä¸ºåº•æ•°aè¿›è¡Œè‹¥å¹²æ¬¡æµ‹è¯•ï¼Œåªè¦æœ‰ä¸€æ¬¡æ²¡æœ‰é€šè¿‡æµ‹è¯•å°±ç«‹å³æŠŠè¿™ä¸ªæ•°æ‰”å›åˆæ•°çš„ä¸–ç•Œã€‚è¿™å°±æ˜¯Fermatç´ æ€§æµ‹è¯•ã€‚</p>
<p>äººä»¬è‡ªç„¶ä¼šæƒ³ï¼Œå¦‚æœè€ƒè™‘äº†æ‰€æœ‰å°äºnçš„åº•æ•°aï¼Œå‡ºé”™çš„æ¦‚ç‡æ˜¯å¦å°±å¯ä»¥é™åˆ°0å‘¢ï¼Ÿæ²¡æƒ³åˆ°çš„æ˜¯ï¼Œå±…ç„¶å°±æœ‰è¿™æ ·çš„åˆæ•°ï¼Œå®ƒå¯ä»¥é€šè¿‡æ‰€æœ‰açš„æµ‹è¯•ï¼ˆè¿™ä¸ªè¯´æ³•ä¸å‡†ç¡®ï¼Œè¯¦è§æˆ‘åœ¨åœ°æ ¸æ¥¼å±‚çš„å›å¤ï¼‰ã€‚Carmichaelç¬¬ä¸€ä¸ªå‘ç°è¿™æ ·æç«¯çš„ä¼ªç´ æ•°ï¼Œä»–æŠŠå®ƒä»¬ç§°ä½œCarmichaelæ•°ã€‚ä½ ä¸€å®šä¼šä»¥ä¸ºè¿™æ ·çš„æ•°ä¸€å®šå¾ˆå¤§ã€‚é”™ã€‚ç¬¬ä¸€ä¸ªCarmichaelæ•°å°å¾—æƒŠäººï¼Œä»…ä»…æ˜¯ä¸€ä¸ªä¸‰ä½æ•°ï¼Œ561ã€‚å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­Carmichaelæ•°ä¹Ÿæœ‰600ä¸ªä¹‹å¤šã€‚Carmichaelæ•°çš„å­˜åœ¨è¯´æ˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»§ç»­åŠ å¼ºç´ æ€§åˆ¤æ–­çš„ç®—æ³•ã€‚</p><footer><strong>Matrix67</strong><cite><a href="http://www.matrix67.com/blog/archives/234" target="_blank" rel="external">æ•°è®ºéƒ¨åˆ†ç¬¬ä¸€èŠ‚ï¼šç´ æ•°ä¸ç´ æ€§æµ‹è¯•</a></cite></footer></blockquote>
<h3 id="Miller-Rabin_ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹">Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹</h3><blockquote>
<p>Miller-Rabinç®—æ³•æ˜¯ç›®å‰ä¸»æµçš„åŸºäºæ¦‚ç‡çš„ç´ æ•°æµ‹è¯•ç®—æ³•ï¼Œåœ¨æ„å»ºå¯†ç å®‰å…¨ä½“ç³»ä¸­å æœ‰é‡è¦çš„åœ°ä½ã€‚é€šè¿‡æ¯”è¾ƒå„ç§ç´ æ•°æµ‹è¯•ç®—æ³•å’Œå¯¹Miller-Rabinç®—æ³•è¿›è¡Œçš„ä»”ç»†ç ”ç©¶ï¼Œè¯æ˜åœ¨è®¡ç®—æœºä¸­æ„å»ºå¯†ç å®‰å…¨ä½“ç³»æ—¶ï¼Œ Miller-Rainç®—æ³•æ˜¯å®Œæˆç´ æ•°æµ‹è¯•çš„æœ€ä½³é€‰æ‹©ã€‚é€šè¿‡å¯¹Miller-Rabin ç®—æ³•åº•å±‚è¿ç®—çš„ä¼˜åŒ–ï¼Œå¯ä»¥å–å¾—è¾ƒä»¥å¾€å®ç°æ›´å¥½çš„æ€§èƒ½ã€‚</p>
</blockquote>
<p>ä»¥ä¸ŠåŸºæœ¬æ²¡ç”¨ã€‚ã€‚ä¸‹é¢æ˜¯è¯¥ç®—æ³•çš„ä¸€äº›å¼•ç†</p>
<blockquote>
<p>äºŒæ¬¡æ¢æµ‹å¼•ç†ï¼šè‹¥pä¸ºå¥‡ç´ æ•°ï¼Œæ–¹ç¨‹x^2â‰¡1(mod p)çš„è§£åªæœ‰Â±1<br>long long èŒƒå›´å†…çš„æ‰€æœ‰æ•´æ•°å‡èƒ½ç”¨å‰9ä¸ªç´ æ•°è¿›è¡Œå‡†ç¡®çš„äºŒæ¬¡æ¢æµ‹</p>
</blockquote>
<h3 id="å®è·µ">å®è·µ</h3><p><a href="http://codevs.cn/problem/1702/" target="_blank" rel="external">codevs1702</a><br>ä¸€ä¸ªæ•°ï¼Œä»–æ˜¯ç´ æ•°ä¹ˆï¼Ÿ<br>è®¾ä»–ä¸ºPæ»¡è¶³(P&lt;=2^63-1)</p>
<p>Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n=<span class="number">16</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">17</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">ll x;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">            ans+=a; ans%=MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        a=(a+a)%MOD;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;x);</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Yes"</span>); <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="è´¨å› æ•°åˆ†è§£æ³•">è´¨å› æ•°åˆ†è§£æ³•</h2><h3 id="O(sqrt(n))æš´åŠ›åˆ†è§£">O(sqrt(n))æš´åŠ›åˆ†è§£</h3><h3 id="Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•">Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•</h3><p>è¿™å‘å¤ªå¤§äº†ï¼Œæœ‰ç‚¹å¡«ä¸åŠ¨è¯¥æ€ä¹ˆåŠã€‚ã€‚ã€‚</p>
<p>ç»è¿‡ä¸€æ™šä¸Šçš„å­¦ä¹ ï¼Œç»ˆäº<del>è¿˜æ˜¯æ²¡æ‡‚</del><br>å…¶å®æ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªå…³äºpollard-rhoç®—æ³•çš„å¾ˆå¥½çš„<a href="http://wenku.baidu.com/link?url=T5oeGiGSqfaurODiXMoErWJS1G8z4M0pnXf24x-gqgxswPyNmxdLdd2UByJPVYAqW-991k5UjJIeABtzQlu1MOGZ4072fQPeBopHiGiPm7m" target="_blank" rel="external">Tutorial</a><br>ç‰µæ‰¯åˆ°åœ†é”¥æ›²çº¿çš„æ–¹é¢<ruby>ä¸è®²äº†<rp> (</rp><rt>tÃ i nÃ¡n liÇo</rt><rp>) </rp></ruby>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œæ·±å…¥ç ”ç©¶ï¼Œç„¶åæˆ‘ä»¬äº†è§£ä¸€ä¸‹pollard-rhoçš„åŸç†ã€‚<br>æ®ç ”ç©¶å¯å¾—(å…·ä½“å¯ä»¥çœ‹é‚£ä¸ªtutorial)ï¼Œå½“æˆ‘ä»¬åœ¨ä¸€å®šèŒƒå›´å†…éšæœºæ•°çš„æ—¶å€™ï¼Œéšè®°ä¸€äº›æ•°å¹¶ä½¿ç”¨å®ƒä»¬çš„å·®å€¼ä½œä¸ºç»“æœæ•ˆæœä¼šè¿œè¿œä¼˜äºæœ´ç´ çš„æšä¸¾æ³•ï¼»ç”Ÿæ—¥æ‚–è®ºï¼½ã€‚<br>åˆ©ç”¨ä»¥ä¸Šæ€§è´¨æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œæ¥éšæœºæšä¸¾ä¸€ä¸ªå¯ä»¥æ•´é™¤å¾…åˆ†è§£å¤§è´¨æ•°çš„æ•°ï¼Œå…·ä½“å¦‚ä¸‹ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥ç”Ÿæˆä¼ªéšæœºæ•°ã€‚<br>æ¢å¥è¯è¯´,æˆ‘ä»¬ä¸æ–­åœ°ä½¿ç”¨å‡½æ•° ğ‘“ æ¥ç”Ÿæˆ(çœ‹ä¸Šå»æˆ–è€…è¯´æ„Ÿè§‰ä¸Šåƒçš„)éšæœºæ•°ã€‚ å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡½éƒ½èƒ½å¤Ÿè¿™æ ·åš,ä½†æ˜¯æœ‰ä¸€ä¸ªç¥å¥‡çš„å‡½æ•°å¯ä»¥ã€‚å®ƒå°±æ˜¯</p>
<blockquote>
<p>$$ f(x)=x^2+c$$</p>
</blockquote>
<p>( æˆ‘ä»¬å¯ä»¥è‡ªå·±æŒ‡å®šğ‘,ä¹Ÿå¯ä»¥ç”¨ rand()éšå³å‡½æ•°æ¥ç”Ÿæˆ,è¿™ä¸æ˜¯é‡ç‚¹ )<br>æˆ‘ä»¬ä»ğ‘¥1 = 2 æˆ–è€…å…¶ä»–æ•°å¼€å§‹,è®©ğ‘¥2 = ğ‘“(ğ‘¥1), ğ‘¥3 = ğ‘“(ğ‘¥2), â€¦ â€¦ ç”Ÿæˆè§„åˆ™ä¸ºğ‘¥ğ‘›+1 = ğ‘“(ğ‘¥ğ‘›)</p>
<p>å…·ä½“å®ç°å’Œè¯¦ç»†è¿‡ç¨‹éƒ½åœ¨é‚£ä»½PDFä¸­ï¼»æˆ‘åªæ˜¯ä¸ªæ¬è¿å·¥ã€‚ã€‚ã€‚</p>
<p>è‡ªå·±å†™çš„bzoj3667, ä¸ºä»€ä¹ˆTäº†ã€‚ã€‚ã€‚ä¸æ‡‚ï¼Œä»¥åå†æ”¹å§ã€‚</p>
<p>é”™è¯¯çš„Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">6</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">24251</span>&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=-<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line">ll x;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;y) swap(x,y);</span><br><span class="line">    ll r = x % y;</span><br><span class="line">    <span class="keyword">while</span> (r!=<span class="number">0</span>)&#123;</span><br><span class="line">        ll tmp = r;</span><br><span class="line">        r = y % r;</span><br><span class="line">        x = y;</span><br><span class="line">        y = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll tmp=(a*b-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)a/p*b+<span class="number">1e-8</span>)*p);</span><br><span class="line">    <span class="keyword">return</span> tmp&lt;<span class="number">0</span>?tmp+p:tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MR</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=NN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (mul(x,x,y)+rand()+<span class="number">12894</span>)%y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Prho</span><span class="params">(ll N)</span></span>&#123;</span><br><span class="line">    ll p=<span class="number">1</span>,t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (MR(N)==<span class="number">1</span>) <span class="keyword">return</span> N;</span><br><span class="line">    ll a=<span class="number">2</span>,b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        a=f(a,N);</span><br><span class="line">        b=f(f(b,N),N);</span><br><span class="line">        <span class="keyword">if</span> (a==b) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (a&gt;b) t=a-b; <span class="keyword">else</span> t=b-a;</span><br><span class="line">        p=gcd(t,N);</span><br><span class="line">        <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">return</span> max(Prho(p),Prho(N/p)); <span class="keyword">else</span> <span class="keyword">return</span> N;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)&#123;</span><br><span class="line">        x=read();</span><br><span class="line">        <span class="keyword">if</span> (x==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"1"</span>); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Prime"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans=Prho(x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‘ç°æˆ‘åœ¨å†™f(x)çš„æ—¶å€™æ¯æ¬¡éƒ½rand()äº†ï¼Œè¿™æ˜¯æç«¯é”™è¯¯çš„ã€‚ã€‚ã€‚<br>è€Œä¸”æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œå¦‚æœåœ¨miller-rabinç®—æ³•ä¸­ç”¨2,3,7,61,24251,é‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªååˆ†å‰å®³çš„å«åš46 856 248 255 981çš„è¶…å¼ºä¼ªç´ æ•°çš„å­˜åœ¨ï¼ŒOTL</p>
<p>ACçš„Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">6</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">24251</span>&#125;;</span><br><span class="line">ll ran;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=-<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line">ll x;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;y) swap(x,y);</span><br><span class="line">    ll r = x % y;</span><br><span class="line">    <span class="keyword">while</span> (r!=<span class="number">0</span>)&#123;</span><br><span class="line">        ll tmp = r;</span><br><span class="line">        r = y % r;</span><br><span class="line">        x = y;</span><br><span class="line">        y = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll tmp=(a*b-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)a/p*b+<span class="number">1e-8</span>)*p);</span><br><span class="line">    <span class="keyword">return</span> tmp&lt;<span class="number">0</span>?tmp+p:tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MR</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">46856248255981</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=NN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (mul(x,x,y)+ran+<span class="number">12894</span>)%y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Prho</span><span class="params">(ll N)</span></span>&#123;</span><br><span class="line">    ll p=<span class="number">1</span>,t=<span class="number">0</span>;</span><br><span class="line">    ll a=<span class="number">2</span>,b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        a=f(a,N);</span><br><span class="line">        b=f(f(b,N),N);</span><br><span class="line">        <span class="keyword">if</span> (a==b) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (a&gt;b) t=a-b; <span class="keyword">else</span> t=b-a;</span><br><span class="line">        p=gcd(t,N);</span><br><span class="line">        <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">4</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    ll p=x;</span><br><span class="line">    <span class="keyword">while</span> (p==x||p==<span class="number">1</span>)&#123;</span><br><span class="line">        ran=rand()+<span class="number">19990128</span>; ran%=x;</span><br><span class="line">        p=Prho(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max(work(p),work(x/p));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)&#123;</span><br><span class="line">        x=read();</span><br><span class="line">        <span class="keyword">if</span> (x==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"1"</span>); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Prime"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans=work(x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>data</strong><br><a href="http://pan.baidu.com/s/1o6064WU" target="_blank" rel="external">http://pan.baidu.com/s/1o6064WU</a></p>]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸­ç§‹å¿«ä¹ï¼<br>ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Vijos1382ï¼šå¯»æ‰¾ä¸»äºº]]></title>
    <link href="http://blog.fractal128.tk/2015/09/27/vijos1382/"/>
    <id>http://blog.fractal128.tk/2015/09/27/vijos1382/</id>
    <published>2015-09-26T17:59:53.000Z</published>
    <updated>2015-09-27T04:10:01.000Z</updated>
    <content type="html"><![CDATA[<p>å¯¹äºåˆšå­¦çš„æœ€å°è¡¨ç¤ºæ³•çš„å·©å›ºã€‚ã€‚ã€‚<br><a id="more"></a><br>é¢˜ç›®ï¼š<a href="https://vijos.org/p/1382" target="_blank" rel="external">vijos p1382</a></p>
<h2 id="Description">Description</h2><p>æœ‰ä¸€å¤©ï¼Œè¢â˜†åŒå­¦ç»µäº†ä¸€æ¡ä»·å€¼è¿åŸå®çŸ³é¡¹é“¾ï¼Œä½†æ˜¯ï¼Œä¸€ä¸ªä¸¥é‡çš„é—®é¢˜æ˜¯ï¼Œä»–ç«Ÿç„¶å¿˜è®°äº†é¡¹é“¾çš„ä¸»äººæ˜¯è°ï¼åœ¨å¾—çŸ¥æ­¤äº‹åï¼Œå¾ˆå¤šäººå‘â˜†åŒå­¦å‘æ¥äº†å¾ˆå¤šé‚®ä»¶ï¼Œéƒ½è¯´é¡¹é“¾æ˜¯è‡ªå·±çš„ï¼Œè¦æ±‚ä»–å½’è¿˜ï¼ˆæ˜¾ç„¶å…¶ä¸­æœ€å¤šåªæœ‰ä¸€ä¸ªäººè¯´äº†çœŸè¯ï¼‰ã€‚ â˜†åŒå­¦è¦æ±‚æ¯ä¸ªäººéƒ½å†™äº†ä¸€æ®µå…³äºè‡ªå·±é¡¹é“¾çš„æè¿°ï¼š é¡¹é“¾ä¸Šçš„å®çŸ³ç”¨æ•°å­—0è‡³9æ¥æ ‡ç¤ºã€‚ä¸€ä¸ªå¯¹äºé¡¹é“¾çš„è¡¨ç¤ºå°±æ˜¯ä»é¡¹é“¾çš„æŸä¸ªå®çŸ³å¼€å§‹ï¼Œé¡ºæŒ‡é’ˆç»•ä¸€åœˆï¼Œæ²¿é€”è®°ä¸‹ç»è¿‡çš„å®çŸ³ï¼Œæ¯”å¦‚å¦‚ä¸‹é¡¹é“¾ï¼š 1-2-3-4 ã€€ã€€å®ƒçš„å¯èƒ½çš„å››ç§è¡¨ç¤ºæ˜¯0123ã€1230ã€2301ã€3012ã€‚<br>è¢â˜†åŒå­¦ç°åœ¨å¿ƒæ€¥å¦‚ç„šï¼Œäºæ˜¯ä»–æ‰¾åˆ°äº†ä½ ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿç¼–ä¸€ä¸ªç¨‹åºï¼Œåˆ¤æ–­ä¸¤ä¸ªç»™å®šçš„æè¿°æ˜¯å¦ä»£è¡¨åŒä¸€ä¸ªé¡¹é“¾ï¼ˆæ³¨æ„ï¼Œé¡¹é“¾æ˜¯ä¸ä¼šç¿»è½¬çš„ï¼‰ã€‚</p>
<p>ç»™å®šä¸¤ä¸ªé¡¹é“¾çš„è¡¨ç¤ºï¼Œåˆ¤æ–­ä»–ä»¬æ˜¯å¦å¯èƒ½æ˜¯ä¸€æ¡é¡¹é“¾ã€‚</p>
<h2 id="Solution">Solution</h2><p>å¯¹äºæ¯”è¾ƒå¾ªç¯åŒæ„çš„æƒ…å†µï¼Œç›´æ¥å¯¹å…¶è¿›è¡Œæœ€å°è¡¨ç¤ºæ³•ï¼Œæ¯”è¾ƒä»–ä»¬çš„æœ€å°è¡¨ç¤ºå³å¯ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">1000000</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p1,p2,t,len;</span><br><span class="line"><span class="keyword">char</span> ch1[maxn],ch2[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minR</span><span class="params">(<span class="keyword">char</span> *a,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>,k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i&lt;n&amp;&amp;j&lt;n&amp;&amp;k&lt;n)&#123;</span><br><span class="line">        t=a[(i+k)%n]-a[(j+k)%n];</span><br><span class="line">        <span class="keyword">if</span> (t==<span class="number">0</span>)&#123;</span><br><span class="line">            k++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (t&gt;<span class="number">0</span>) i+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (t&lt;<span class="number">0</span>) j+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i==j) i++;</span><br><span class="line">            k=<span class="number">0</span>; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> min(i,j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,ch1);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,ch2);</span><br><span class="line">    len=<span class="built_in">strlen</span>(ch1);</span><br><span class="line">    p1=minR(ch1,len);</span><br><span class="line">    p2=minR(ch2,len);</span><br><span class="line">    <span class="keyword">bool</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++)</span><br><span class="line">        <span class="keyword">if</span> (ch1[(i+p1)%len]!=ch2[(i+p2)%len])&#123;</span><br><span class="line">            flag=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,ch1[(i+p1)%len]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>å¯¹äºåˆšå­¦çš„æœ€å°è¡¨ç¤ºæ³•çš„å·©å›ºã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="vijos" scheme="http://blog.fractal128.tk/tags/vijos/"/>
    
      <category term="æœ€å°è¡¨ç¤ºæ³•" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æœ€å°è¡¨ç¤ºæ³•" scheme="http://blog.fractal128.tk/categories/OI/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ2882: å·¥è‰º]]></title>
    <link href="http://blog.fractal128.tk/2015/09/27/bzoj2882/"/>
    <id>http://blog.fractal128.tk/2015/09/27/bzoj2882/</id>
    <published>2015-09-26T17:18:59.000Z</published>
    <updated>2015-09-26T17:37:28.000Z</updated>
    <content type="html"><![CDATA[<p>ç¬¬ä¸€é“æƒé™é¢˜ã€‚<br><a id="more"></a><br>é¢˜ç›®é“¾æ¥<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2882" target="_blank" rel="external">æˆ³</a></p>
<h2 id="Description">Description</h2><p>å°æ•å’Œå°ç‡•æ˜¯ä¸€å¯¹å¥½æœ‹å‹ã€‚<br>ä»–ä»¬æ­£åœ¨ç©ä¸€ç§ç¥å¥‡çš„æ¸¸æˆï¼Œå«Minecraftã€‚<br>ä»–ä»¬ç°åœ¨è¦åšä¸€ä¸ªç”±æ–¹å—æ„æˆçš„é•¿æ¡å·¥è‰ºå“ã€‚ä½†æ˜¯æ–¹å—ç°åœ¨æ˜¯ä¹±çš„ï¼Œè€Œä¸”ç”±äºæœºå™¨çš„è¦æ±‚ï¼Œä»–ä»¬åªèƒ½åšåˆ°æŠŠè¿™ä¸ªå·¥è‰ºå“æœ€å·¦è¾¹çš„æ–¹å—æ”¾åˆ°æœ€å³è¾¹ã€‚<br>ä»–ä»¬æƒ³ï¼Œåœ¨ä»…è¿™ä¸€ä¸ªæ“ä½œä¸‹ï¼Œæœ€æ¼‚äº®çš„å·¥è‰ºå“èƒ½å¤šæ¼‚äº®ã€‚<br>ä¸¤ä¸ªå·¥è‰ºå“ç¾è§‚çš„æ¯”è¾ƒæ–¹æ³•æ˜¯ï¼Œä»å¤´å¼€å§‹æ¯”è¾ƒï¼Œå¦‚æœç¬¬iä¸ªä½ç½®ä¸Šæ–¹å—ä¸ä¸€æ ·é‚£ä¹ˆè°çš„ç‘•ç–µåº¦å°ï¼Œé‚£ä¹ˆè°å°±æ›´æ¼‚äº®ï¼Œå¦‚æœä¸€æ ·é‚£ä¹ˆç»§ç»­æ¯”è¾ƒç¬¬i+1ä¸ªæ–¹å—ã€‚å¦‚æœå…¨éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå·¥è‰ºå“å°±ä¸€æ ·æ¼‚äº®ã€‚</p>
<h2 id="Solution">Solution</h2><p>å­¦äº†ä¸€ä¸‹æœ€å°è¡¨ç¤ºæ³•ï¼Œä¸»è¦ä½œç”¨æ˜¯æ‰¾å‡ºå¾ªç¯åŒæ„çš„æ•°æ®çš„æœ€å°è¡¨ç¤ºã€‚<br>ä¸€å¼€å§‹ç›´æ¥çœ‹ä»£ç æœ‰ç‚¹ä¸æ‡‚ï¼Œåæ¥ç¨å¾®æƒ³äº†æƒ³ï¼Œå·®ä¸å¤šæ˜ç™½äº†ï¼»å…¶å®è¿™ä¹ˆçŸ­ï¼Œä¸€ä¸‹å°±èƒŒå‡ºæ¥äº†ã€‚ã€‚<br>å¤§æ¦‚æ€æƒ³å°±æ˜¯ç”¨ä¸¤ä¸ªæŒ‡é’ˆé€‰å–é¦–ä½è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒå°±ä¸€ç›´å¾€ä¸‹æ¯”è¾ƒï¼Œå½“è¾¾åˆ°äº†lençš„é•¿åº¦å°±è¯´æ˜å·²ç»å¾—åˆ°äº†ç­”æ¡ˆã€‚å…·ä½“è¯·å‚çœ‹ä»£ç ã€‚</p>
<h2 id="Code">Code</h2><p>ps.è¿™é¢˜å¯¹presentationæœ‰è¦æ±‚ï¼Œæœ«å°¾ä¸èƒ½æœ‰ç©ºæ ¼ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,p,t;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1000000</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minR</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>,k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i&lt;n&amp;&amp;j&lt;n&amp;&amp;k&lt;n)&#123;</span><br><span class="line">        t=a[(i+k)%n]-a[(j+k)%n];</span><br><span class="line">        <span class="keyword">if</span> (t==<span class="number">0</span>)&#123;</span><br><span class="line">            k++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (t&gt;<span class="number">0</span>) i+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (t&lt;<span class="number">0</span>) j+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i==j) i++;</span><br><span class="line">            k=<span class="number">0</span>; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> min(i,j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    p=minR();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n-<span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,a[(i+p)%n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,a[(n-<span class="number">1</span>+p)%n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¬¬ä¸€é“æƒé™é¢˜ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="æœ€å°è¡¨ç¤ºæ³•" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æœ€å°è¡¨ç¤ºæ³•" scheme="http://blog.fractal128.tk/categories/OI/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[uva10635:Prince and Princess]]></title>
    <link href="http://blog.fractal128.tk/2015/09/26/uva10635/"/>
    <id>http://blog.fractal128.tk/2015/09/26/uva10635/</id>
    <published>2015-09-25T18:38:10.000Z</published>
    <updated>2015-09-26T05:26:06.000Z</updated>
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡ä½¿ç”¨virtual judgeï¼Œå±…ç„¶äº¤äº†å¾ˆå¤šéä»£ç éƒ½æ²¡äº¤ä¸Šå»ã€‚ã€‚ã€‚<br><a id="more"></a><br>virtual judgeæäº¤<a href="http://acm.hust.edu.cn/vjudge/problem/viewProblem.action?id=19051" target="_blank" rel="external">å…¥å£</a></p>
<h2 id="Description">Description</h2><p>è‹±æ–‡é¢˜é¢çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚<br>å¤§æ¦‚å°±æ˜¯æ±‚ä¸ªLCSå§ã€‚</p>
<h2 id="Solution">Solution</h2><p>å°†ç¬¬äºŒä¸ªåºåˆ—å…ƒç´ åœ¨ç¬¬ä¸€ä¸ªåºåˆ—ä¸­çš„æ¬¡åºå€’åºæ’èµ·æ¥åšä¸€éLISå³å¯ã€‚<br>æ—¶é—´å¤æ‚åº¦å¯é™è‡³Î˜(nlogn)ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼š<br>s1: 5 4 3 5 2<br>s2: 4 2 3 3 5<br>å¤„ç†åå¾—åˆ°çš„åºåˆ—åˆ™ä¸º: 2 5 3 3 4 1<br>æ‰€ä»¥ans=3</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> inf <span class="number">1000000000</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">6500000</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> c[maxn],a[maxn],t[maxn];</span><br><span class="line"><span class="keyword">int</span> nex[maxn],fir[maxn],f[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T,ans;</span><br><span class="line"><span class="keyword">int</span> n,p,q,num;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T); <span class="keyword">int</span> tt=T;</span><br><span class="line">    <span class="keyword">while</span> (T--)&#123;</span><br><span class="line">        num=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(fir,<span class="number">0</span>,<span class="keyword">sizeof</span>(fir));</span><br><span class="line">        <span class="built_in">memset</span>(nex,<span class="number">0</span>,<span class="keyword">sizeof</span>(nex));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;p,&amp;q);</span><br><span class="line">        p++; q++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=p; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t[i]);</span><br><span class="line">            nex[i]=fir[t[i]]; fir[t[i]]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=q; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">            <span class="keyword">int</span> u=fir[x];</span><br><span class="line">            <span class="keyword">while</span> (u)&#123;</span><br><span class="line">                a[++num]=u;</span><br><span class="line">                u=nex[u];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//		for (int i=1; i&lt;=num; i++) cout&lt;&lt;a[i]&lt;&lt;endl;</span></span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n*n; i++) c[i]=inf;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=num; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> l=<span class="number">0</span>,r=num;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;=r)&#123;</span><br><span class="line">                <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (c[mid]&lt;a[i])&#123;</span><br><span class="line">                    tmp=mid;</span><br><span class="line">                    l=mid+<span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> r=mid-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            f[i]=tmp+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (c[tmp+<span class="number">1</span>]&gt;a[i]) c[tmp+<span class="number">1</span>]=a[i];</span><br><span class="line">            <span class="keyword">if</span> (f[i]&gt;ans) ans=f[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"Case "</span>&lt;&lt;tt-T&lt;&lt;<span class="string">": "</span>&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¬¬ä¸€æ¬¡ä½¿ç”¨virtual judgeï¼Œå±…ç„¶äº¤äº†å¾ˆå¤šéä»£ç éƒ½æ²¡äº¤ä¸Šå»ã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="uva" scheme="http://blog.fractal128.tk/tags/uva/"/>
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="http://blog.fractal128.tk/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="åŠ¨æ€è§„åˆ’" scheme="http://blog.fractal128.tk/categories/OI/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ1876: [SDOI2009]SuperGCD]]></title>
    <link href="http://blog.fractal128.tk/2015/09/26/bzoj1876/"/>
    <id>http://blog.fractal128.tk/2015/09/26/bzoj1876/</id>
    <published>2015-09-25T18:27:32.000Z</published>
    <updated>2015-09-26T05:16:19.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸ä¼šå†™é«˜ç²¾åº¦çš„æˆ‘è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br><a id="more"></a></p>
<h2 id="Description">Description</h2><p>Sheng billæœ‰ç€æƒŠäººçš„å¿ƒç®—èƒ½åŠ›ï¼Œç”šè‡³èƒ½ç”¨å¤§è„‘è®¡ç®—å‡ºä¸¤ä¸ªå·¨å¤§çš„æ•°çš„GCDï¼ˆæœ€å¤§å…¬çº¦ æ•°ï¼‰ï¼å› æ­¤ä»–ç»å¸¸å’Œåˆ«äººæ¯”èµ›è®¡ç®—GCDã€‚æœ‰ä¸€å¤©Sheng billå¾ˆåš£å¼ åœ°æ‰¾åˆ°äº†ä½ ï¼Œå¹¶è¦æ±‚å’Œä½ æ¯” èµ›ï¼Œä½†æ˜¯è¾“ç»™Sheng billå²‚ä¸æ˜¯å¾ˆä¸¢è„¸ï¼æ‰€ä»¥ä½ å†³å®šå†™ä¸€ä¸ªç¨‹åºæ¥æ•™è®­ä»–ã€‚</p>
<h2 id="Solution">Solution</h2><p>è£¸æ›´ç›¸å‡æŸæœ¯å®ç°ï¼»å†™é«˜ç²¾åº¦è¶…æ—¶çš„æˆ‘åªèƒ½å‘µå‘µã€‚ã€‚ã€‚</p>
<h2 id="Code">Code</h2><p>å†™è¶…æ—¶äº†æ€ä¹ˆè¿˜èƒ½è´´ä»£ç å‘¢ï¼Ÿ<br>ä½†æ˜¯çœ‹åˆ°äº†ä¸€ä¸ªå¾ˆå‰å®³çš„ä¸œè¥¿(pythonå¤§æ³•å¥½)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a,b=input(),input()</span><br><span class="line">c=a%b</span><br><span class="line"><span class="keyword">while</span> c!=<span class="number">0L</span>:</span><br><span class="line">    a=b</span><br><span class="line">    b=c</span><br><span class="line">    c=a%b</span><br><span class="line"><span class="keyword">print</span> b</span><br></pre></td></tr></table></figure></p>]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸ä¼šå†™é«˜ç²¾åº¦çš„æˆ‘è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åˆç­‰æ•°è®ºï¼ˆä¸€ï¼‰]]></title>
    <link href="http://blog.fractal128.tk/2015/09/18/number-theory1/"/>
    <id>http://blog.fractal128.tk/2015/09/18/number-theory1/</id>
    <published>2015-09-18T11:51:32.000Z</published>
    <updated>2015-09-20T04:47:37.000Z</updated>
    <content type="html"><![CDATA[<p>å‘¨å››å¬äº†ä¸€ä¸ªé«˜ä¸€å°çˆ·è®²äº†ä¸€å †å¬ä¸æ‡‚çš„æ•°è®ºï¼Œè™å¾—ä½“æ— å®Œè‚¤ï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ æˆ‘ç´§å¼ å¾—ä¸€ä¸‹è¯¾å°±è·‘äº†å—ï¼ŒçœŸæ˜¯æç¬‘äº†ã€‚ç‰¹æ­¤æ‰“ä¸Šè‡ªæˆ‘åçœçš„tagä»¥è­¦é†’ã€‚æ‰¾åˆ°äº†æš‘å‡ä¸Šè¯¾æ—¶QYç¥çŠ‡çš„è¯¾ä»¶ï¼Œå¥½å¥½å­¦ã€‚ã€‚ã€‚<br><a id="more"></a></p>
<h1 id="åˆç­‰æ•°è®º">åˆç­‰æ•°è®º</h1><h2 id="æ•°è®ºå¸¸è¯†">æ•°è®ºå¸¸è¯†</h2><ol>
<li>æ•´æ•°ï¼æ•´é™¤ï¼çº¦æ•°</li>
<li>ç´ æ•°ï¼åˆæ•°</li>
<li>ç®—æ•°åŸºæœ¬å®šç†ï¼šä»»ä½•ä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•° N,å¦‚æœNä¸ä¸ºè´¨æ•°ï¼Œé‚£ä¹ˆNå¯ä»¥å”¯ä¸€åˆ†è§£æˆæœ‰é™ä¸ªè´¨æ•°çš„ä¹˜ç§¯ N=P1^a1<em>P2^a2\</em>P3^a3â€¦â€¦*Pn^anï¼Œè¿™é‡ŒP1&lt;P2&lt;P3â€¦â€¦&lt;Pnå‡ä¸ºè´¨æ•°ï¼Œå…¶ä¸­æŒ‡æ•°aiæ˜¯æ­£æ•´æ•°ã€‚</li>
<li>é™¤æ³•ï¼åŒä½™</li>
<li>æœ€å¤§å…¬å› æ•°ï¼æœ€å°å…¬å€æ•°</li>
<li>ç´ æ•°æ— é™å®šç†ï¼šè¯æ˜å¯é‡‡ç”¨æ„é€ æ³•ï¼Œå°†æ‰€æœ‰å·²çŸ¥è´¨æ•°ç›¸ä¹˜ï¼‹1å¾—åˆ°ä¸è¢«å…¶ä»–è´¨æ•°æ‰€æ•´é™¤çš„æ–°è´¨æ•°ã€‚</li>
<li>äº’ç´ </li>
<li>è¿›åˆ¶ä½</li>
</ol>
<h2 id="æ¬§å‡ é‡Œå¾·ç®—æ³•">æ¬§å‡ é‡Œå¾·ç®—æ³•</h2><h3 id="è¾—è½¬ç›¸é™¤æ³•">è¾—è½¬ç›¸é™¤æ³•</h3><p>$$ gcd(a,b)=gcd(b,a\%b)$$<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?gcd(b,a % b):a;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ›´ç›¸å‡æŸæœ¯">æ›´ç›¸å‡æŸæœ¯</h3><p>$$ 1.gcd(a,b)=gcd(a,a-b)$$$$ 2.gcd(2a,2b)=2gcd(a,b)$$$$3.gcd(2a,b)=gcd(a,b)$$<br>æˆ‘ä¹Ÿä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ç™¾åº¦ä¸€ä¸‹å˜›ã€‚ã€‚ã€‚<br>æŸ¥åˆ°äº†ï¼BZOJ1876ï¼Œæ±‚é«˜ç²¾åº¦gcd,<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=1876" target="_blank" rel="external">ä¼ é€é—¨</a></p>
<h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾·exgcd">æ‰©å±•æ¬§å‡ é‡Œå¾·exgcd</h3><p>ä½¿ç”¨Qyçš„ä¸€å¼ å›¾ä¾¿è¯´æ˜é—®é¢˜ã€‚<br><img src="http://7xl5lt.com1.z0.glb.clouddn.com/å›¾ç‰‡1.png" alt="ORZ(QY)"><br>è¿˜æœ‰ä¸€å‘ç¥ç‰›çš„è®²è¯¾æ‰‹å†™ä»£ç ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x=<span class="number">1</span>;y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> re=exgcd(b,a%b,x,y);</span><br><span class="line">        <span class="keyword">int</span> tmp=x;</span><br><span class="line">        x=y;</span><br><span class="line">        y=tmp-a/b*y;</span><br><span class="line">        <span class="keyword">return</span> re;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a,b,x,y;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;exgcd(a,b,x,y)&lt;&lt;<span class="string">' '</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="string">' '</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line">    system(<span class="string">"pause"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="è£´èœ€å®šç†">è£´èœ€å®šç†</h2><p>è£´èœ€å®šç†ï¼ˆBÃ©zoutâ€™s identityï¼‰å¾—åäºæ³•å›½æ•°å­¦å®¶è‰¾è’‚å®‰Â·è£´èœ€ï¼Œè¯´æ˜äº†å¯¹ä»»ä½•æ•´æ•°aã€bå’Œå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°dï¼Œå…³äºæœªçŸ¥æ•°xå’Œyçš„çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ï¼ˆç§°ä¸ºè£´èœ€ç­‰å¼ï¼‰ï¼šè‹¥a,bæ˜¯æ•´æ•°,ä¸”ï¼ˆa,b)=dï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„æ•´æ•°x,y,ax+byéƒ½ä¸€å®šæ˜¯dçš„å€æ•°ï¼Œç‰¹åˆ«åœ°ï¼Œä¸€å®šå­˜åœ¨æ•´æ•°x,yï¼Œä½¿ax+by=dæˆç«‹ã€‚</p>
<p>å®ƒçš„ä¸€ä¸ªé‡è¦æ¨è®ºæ˜¯ï¼ša,bäº’è´¨çš„å……è¦æ¡ä»¶æ˜¯å­˜åœ¨æ•´æ•°x,yä½¿ax+by=1.</p>
<p>å®ƒçš„ä¸€ä¸ªé‡è¦æ¨è®ºæ˜¯ï¼šè®¾a1,a2,a3â€¦â€¦anä¸ºnä¸ªæ•´æ•°ï¼Œdæ˜¯å®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°ï¼Œé‚£ä¹ˆå­˜åœ¨æ•´æ•°x1â€¦â€¦xnä½¿å¾—x1*a1+x2*a2+â€¦xn*an=dã€‚</p>
<p>è¯æ˜å¯ç”±æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•ç›´è§‚å¾—åˆ°TAT!~[è¿‘è·ç¦»è†œæ‹œå¤§çˆ·å–èŒ]</p>]]></content>
    <summary type="html">
    <![CDATA[<p>å‘¨å››å¬äº†ä¸€ä¸ªé«˜ä¸€å°çˆ·è®²äº†ä¸€å †å¬ä¸æ‡‚çš„æ•°è®ºï¼Œè™å¾—ä½“æ— å®Œè‚¤ï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ æˆ‘ç´§å¼ å¾—ä¸€ä¸‹è¯¾å°±è·‘äº†å—ï¼ŒçœŸæ˜¯æç¬‘äº†ã€‚ç‰¹æ­¤æ‰“ä¸Šè‡ªæˆ‘åçœçš„tagä»¥è­¦é†’ã€‚æ‰¾åˆ°äº†æš‘å‡ä¸Šè¯¾æ—¶QYç¥çŠ‡çš„è¯¾ä»¶ï¼Œå¥½å¥½å­¦ã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E8%AE%BA/"/>
    
      <category term="é¢å£åçœ" scheme="http://blog.fractal128.tk/tags/%E9%9D%A2%E5%A3%81%E5%8F%8D%E7%9C%81/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°è®º" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ2127:happiness]]></title>
    <link href="http://blog.fractal128.tk/2015/09/18/bzoj2127/"/>
    <id>http://blog.fractal128.tk/2015/09/18/bzoj2127/</id>
    <published>2015-09-18T10:39:07.000Z</published>
    <updated>2015-09-19T11:34:01.000Z</updated>
    <content type="html"><![CDATA[<p>æƒ³äº†ä¸€ä¸ªç¤¼æ‹œæ‰å‘ç°è‡ªå·±å¿˜è®°äº†æ„åŒå‘è¾¹ï¼Œä¹Ÿæ˜¯é†‰äº†ï¼Œä¸€ç¤¼æ‹œä¸€é“é¢˜çš„é¾Ÿé€Ÿä¹Ÿæ˜¯é†‰äº†ã€‚ã€‚ã€‚å¬äº†å‡ éåŒå­¦æ¨èçš„<a href="https://en.wikipedia.org/wiki/Owl_City" target="_blank" rel="external">Owl City</a>çš„ç”µå­ç±»çš„éŸ³ä¹ï¼Œè¿˜ä¸é”™çš„æ ·å­ï¼Œå¥½æ­¹ä¹Ÿæ˜¯ä¸Šè¿‡Billboardçš„ï¼Œå¼ºè¡Œå®‰åˆ©ä¸€å‘å¥½äº†ã€‚ã€‚ã€‚<br><a id="more"></a></p>
<p>è¿æ¥åœ¨æ­¤<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2127" target="_blank" rel="external">ğŸ”—</a></p>
<h2 id="Description">Description</h2><p>é«˜ä¸€ä¸€ç­çš„åº§ä½è¡¨æ˜¯ä¸ªn*mçš„çŸ©é˜µï¼Œç»è¿‡ä¸€ä¸ªå­¦æœŸçš„ç›¸å¤„ï¼Œæ¯ä¸ªåŒå­¦å’Œå‰åå·¦å³ç›¸é‚»çš„åŒå­¦äº’ç›¸æˆä¸ºäº†å¥½æœ‹å‹ã€‚è¿™å­¦æœŸè¦åˆ†æ–‡ç†ç§‘äº†ï¼Œæ¯ä¸ªåŒå­¦å¯¹äºé€‰æ‹©æ–‡ç§‘ä¸ç†ç§‘æœ‰ç€è‡ªå·±çš„å–œæ‚¦å€¼ï¼Œè€Œä¸€å¯¹å¥½æœ‹å‹å¦‚æœèƒ½åŒæ—¶é€‰æ–‡ç§‘æˆ–è€…ç†ç§‘ï¼Œé‚£ä¹ˆä»–ä»¬åˆå°†æ”¶è·ä¸€äº›å–œæ‚¦å€¼ã€‚ä½œä¸ºè®¡ç®—æœºç«èµ›æ•™ç»ƒçš„scpå¤§è€æ¿ï¼Œæƒ³çŸ¥é“å¦‚ä½•åˆ†é…å¯ä»¥ä½¿å¾—å…¨ç­çš„å–œæ‚¦å€¼æ€»å’Œæœ€å¤§ã€‚</p>
<h2 id="Solution">Solution</h2><p>æ„Ÿè§‰æœ‰ç‚¹åƒæ˜¯æœ€å¤§ç‚¹æƒé—­åˆå›¾çš„æ„Ÿè§‰ï¼Œç”¨æœ€å°å‰²æ±‚å‡ºæœ€å°‘ä¸èƒ½å¾—åˆ°å–œæ‚¦å€¼ï¼Œç„¶åç”¨æ‰€æœ‰çš„æ€»å–œæ‚¦å€¼å‡å»æœ€å°å‰²çš„ç­”æ¡ˆå¾—åˆ°é—®é¢˜æ‰€æ±‚çš„ç­”æ¡ˆã€‚<br>å…·ä½“æ„å›¾çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š  </p>
<ul>
<li>æºç‚¹å’Œæ‰€æœ‰è¡¨ç¤ºåŒå­¦çš„ç‚¹è¿è¾¹ï¼Œæµé‡ä¸ºè¯¥å­¦ç”Ÿé€‰å–æ–‡ç§‘æ‰€å¾—åˆ°çš„å–œæ‚¦å€¼åŠ ä¸Šå› ä¸ºä»–å’Œå…¶ä»–ç‚¹ä¸€èµ·é€‰æ–‡ç§‘å¾—åˆ°çš„å–œæ‚¦é™„åŠ å€¼çš„ä¸€åŠã€‚  </li>
<li>æ±‡ç‚¹ä¸å„ç‚¹è¿è¾¹ï¼Œæµé‡å’ŒåŒæºç‚¹ï¼Œæ”¹æˆé€‰ç†ç§‘çš„å°±å¥½ã€‚  </li>
<li>å¯¹äºæ¯ä¸€å¯¹ç›¸é‚»çš„ç‚¹ï¼Œ<strong>ç›¸äº’</strong><del>å‚»é€¼é”™è¯¯å°±æ˜¯è¿™ä¹ˆå‡ºç°çš„</del>è¿è¾¹ï¼Œæµé‡ä¸ºä¸€åŠçš„ä»–ä»¬åŒæ—¶é€‰æ–‡ç§‘çš„å€¼åŠ ä¸Šä¸€åŠä»–ä»¬é€‰ç†ç§‘çš„å€¼ã€‚<br>å¯èƒ½ä¸€å¼€å§‹ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œè‡ªå·±ç”»ä¸€ä¸‹ä¸¤ä¸ªç‚¹çš„å›¾ï¼Œä¼šå‘ç°ï¼Œä¸‰ç§æƒ…å†µéƒ½æ˜¯å¯ä»¥æ­£ç¡®è¡¨ç¤ºçš„ã€‚</li>
</ul>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">200000</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> inf <span class="number">0x7fffffff</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> s,t,n,m,tot;</span><br><span class="line"><span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">struct</span> edge&#123;</span><br><span class="line">    <span class="keyword">int</span> cap,op,nex,to,flow;</span><br><span class="line">&#125;e[maxn];</span><br><span class="line"><span class="keyword">int</span> fir[maxn],nex[maxn],w[maxn],S[maxn],T[maxn],cur[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ex</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x-<span class="number">1</span>)*m+y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span></span>&#123;</span><br><span class="line">    e[++tot].cap=cap; e[tot].to=y; e[tot].op=tot+<span class="number">1</span>; nex[tot]=fir[x]; fir[x]=tot;</span><br><span class="line">    e[++tot].cap=<span class="number">0</span>; e[tot].to=x; e[tot].op=tot-<span class="number">1</span>; nex[tot]=fir[y]; fir[y]=tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    vis[s]=<span class="number">1</span>; w[s]=<span class="number">0</span>; Q.push(s);</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front(); Q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u=fir[x]; u; u=nex[u])&#123;</span><br><span class="line">            <span class="keyword">int</span> v=e[u].to;</span><br><span class="line">            <span class="keyword">if</span> (!vis[v]&amp;&amp;e[u].cap&gt;e[u].flow)&#123;</span><br><span class="line">                vis[v]=<span class="number">1</span>; Q.push(v); w[v]=w[x]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (vis[t]) <span class="keyword">return</span> <span class="literal">true</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x==t||a==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>,f;</span><br><span class="line">    <span class="keyword">while</span> (cur[x]!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> u=cur[x];</span><br><span class="line">        <span class="keyword">int</span> v=e[u].to;</span><br><span class="line">        <span class="keyword">if</span> (w[x]+<span class="number">1</span>==w[v]&amp;&amp;(f=dfs(v,min(a,e[u].cap-e[u].flow))) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            e[u].flow+=f; e[e[u].op].flow-=f;</span><br><span class="line">            flow+=f;</span><br><span class="line">            a-=f;</span><br><span class="line">            <span class="keyword">if</span> (a==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur[x]=nex[cur[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxflow</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (bfs())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=t; i++) cur[i]=fir[i];</span><br><span class="line">        flow+=dfs(s,inf);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m); s=<span class="number">0</span>; t=n*m+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            S[ex(i,j)]+=<span class="number">2</span>*x;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            T[ex(i,j)]+=<span class="number">2</span>*x;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            S[ex(i,j)]+=x;</span><br><span class="line">            S[ex(i+<span class="number">1</span>,j)]+=x;</span><br><span class="line">            add(ex(i,j),ex(i+<span class="number">1</span>,j),x); add(ex(i+<span class="number">1</span>,j),ex(i,j),x);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            T[ex(i,j)]+=x;</span><br><span class="line">            T[ex(i+<span class="number">1</span>,j)]+=x;</span><br><span class="line">            add(ex(i,j),ex(i+<span class="number">1</span>,j),x); add(ex(i+<span class="number">1</span>,j),ex(i,j),x);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            S[ex(i,j)]+=x;</span><br><span class="line">            S[ex(i,j+<span class="number">1</span>)]+=x;</span><br><span class="line">            add(ex(i,j),ex(i,j+<span class="number">1</span>),x); add(ex(i,j+<span class="number">1</span>),ex(i,j),x);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;m; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x); sum+=x;</span><br><span class="line">            T[ex(i,j)]+=x;</span><br><span class="line">            T[ex(i,j+<span class="number">1</span>)]+=x;</span><br><span class="line">            add(ex(i,j),ex(i,j+<span class="number">1</span>),x); add(ex(i,j+<span class="number">1</span>),ex(i,j),x);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n*m; i++)&#123;</span><br><span class="line">        add(s,i,S[i]); add(i,t,T[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, sum-maxflow()/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Music">Music</h2><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="335" height="86" src="http://music.163.com/outchain/player?type=2&id=1807836&auto=1&height=66"></iframe>]]></content>
    <summary type="html">
    <![CDATA[<p>æƒ³äº†ä¸€ä¸ªç¤¼æ‹œæ‰å‘ç°è‡ªå·±å¿˜è®°äº†æ„åŒå‘è¾¹ï¼Œä¹Ÿæ˜¯é†‰äº†ï¼Œä¸€ç¤¼æ‹œä¸€é“é¢˜çš„é¾Ÿé€Ÿä¹Ÿæ˜¯é†‰äº†ã€‚ã€‚ã€‚å¬äº†å‡ éåŒå­¦æ¨èçš„<a href="https://en.wikipedia.org/wiki/Owl_City">Owl City</a>çš„ç”µå­ç±»çš„éŸ³ä¹ï¼Œè¿˜ä¸é”™çš„æ ·å­ï¼Œå¥½æ­¹ä¹Ÿæ˜¯ä¸Šè¿‡Billboardçš„ï¼Œå¼ºè¡Œå®‰åˆ©ä¸€å‘å¥½äº†ã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="æœ€å°å‰²" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%B0%8F%E5%89%B2/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/categories/OI/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ1054: [HAOI2008]ç§»åŠ¨ç©å…·]]></title>
    <link href="http://blog.fractal128.tk/2015/09/11/bzoj1054/"/>
    <id>http://blog.fractal128.tk/2015/09/11/bzoj1054/</id>
    <published>2015-09-11T12:15:20.000Z</published>
    <updated>2015-09-12T16:28:07.000Z</updated>
    <content type="html"><![CDATA[<p><del>å¼ºæƒä¸‹</del>è½¬ç”¨LJOJã€‚ã€‚ã€‚å¯èƒ½æ˜¯è¦æš‚æ—¶å‘Šåˆ«BZOJçš„æ„æ€<br>è§è¯†äº†LJçš„BZOJçš„rootè´¦å·ï¼Œç„¶è€Œç™»è¿›äº†adminåå°å´ä¸ä¼šç”¨ã€‚ã€‚ã€‚<br>æœ€è¿‘çœ‹äº†minionså°±ç”¨å®ƒçš„ç…§ç‰‡å§= =<br><a id="more"></a></p>
<h2 id="Description">Description</h2><p>åœ¨ä¸€ä¸ª4*4çš„æ–¹æ¡†å†…æ‘†æ”¾äº†è‹¥å¹²ä¸ªç›¸åŒçš„ç©å…·ï¼ŒæŸäººæƒ³å°†è¿™äº›ç©å…·é‡æ–°æ‘†æ”¾æˆä¸ºä»–å¿ƒä¸­ç†æƒ³çš„çŠ¶æ€ï¼Œè§„å®šç§»åŠ¨æ—¶åªèƒ½å°†ç©å…·å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œå¹¶ä¸”ç§»åŠ¨çš„ä½ç½®ä¸èƒ½æœ‰ç©å…·ï¼Œè¯·ä½ ç”¨æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°å°†åˆå§‹çš„ç©å…·çŠ¶æ€ç§»åŠ¨åˆ°æŸäººå¿ƒä¸­çš„ç›®æ ‡çŠ¶æ€ã€‚</p>
<h2 id="Solution">Solution</h2><p>åªä¼šå¼ºåŠ›BFS,ä¹Ÿä¸æ˜¯å¾ˆæ…¢å˜›ï½ç”¨rootçœ‹åˆ«äººçš„ç¨‹åºï¼ŒA*/IDA*å±…å¤šï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨KMçš„çœŸæ˜¯åªèƒ½è†œè†œè†œã€‚ã€‚ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">100000</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> S=<span class="number">0</span>,E=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> f[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">gett</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'1'</span>||ch&lt;<span class="string">'0'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    Q.push(S); f[S]=<span class="number">0</span>; vis[S]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front(); Q.pop();</span><br><span class="line">        <span class="keyword">int</span> tmp=x,s=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (tmp&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> ((tmp&amp;<span class="number">1</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> ((s%<span class="number">4</span>!=<span class="number">0</span>)&amp;&amp;((x&amp;(<span class="number">1</span>&lt;&lt;(s-<span class="number">1</span>)))==<span class="number">0</span>))&#123;</span><br><span class="line">                    <span class="keyword">int</span> v=x|(<span class="number">1</span>&lt;&lt;(s-<span class="number">1</span>));</span><br><span class="line">                    v=v-(<span class="number">1</span>&lt;&lt;s);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])&#123;</span><br><span class="line">                        Q.push(v);</span><br><span class="line">                        vis[v]=<span class="number">1</span>; f[v]=f[x]+<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span> (v==E) <span class="keyword">return</span> f[v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (((s&amp;<span class="number">3</span>)!=<span class="number">3</span>)&amp;&amp;((x&amp;(<span class="number">1</span>&lt;&lt;(s+<span class="number">1</span>)))==<span class="number">0</span>))&#123;</span><br><span class="line">                    <span class="keyword">int</span> v=x|(<span class="number">1</span>&lt;&lt;(s+<span class="number">1</span>));</span><br><span class="line">                    v=v-(<span class="number">1</span>&lt;&lt;s);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])&#123;</span><br><span class="line">                        Q.push(v);</span><br><span class="line">                        vis[v]=<span class="number">1</span>; f[v]=f[x]+<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span> (v==E) <span class="keyword">return</span> f[v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (((s&gt;<span class="number">3</span>))&amp;&amp;((x&amp;(<span class="number">1</span>&lt;&lt;(s-<span class="number">4</span>)))==<span class="number">0</span>))&#123;</span><br><span class="line">                    <span class="keyword">int</span> v=x|(<span class="number">1</span>&lt;&lt;(s-<span class="number">4</span>));</span><br><span class="line">                    v=v-(<span class="number">1</span>&lt;&lt;s);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])&#123;</span><br><span class="line">                        Q.push(v);</span><br><span class="line">                        vis[v]=<span class="number">1</span>; f[v]=f[x]+<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span> (v==E) <span class="keyword">return</span> f[v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (((s&lt;<span class="number">12</span>))&amp;&amp;((x&amp;(<span class="number">1</span>&lt;&lt;(s+<span class="number">4</span>)))==<span class="number">0</span>))&#123;</span><br><span class="line">                    <span class="keyword">int</span> v=x|(<span class="number">1</span>&lt;&lt;(s+<span class="number">4</span>));</span><br><span class="line">                    v=v-(<span class="number">1</span>&lt;&lt;s);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])&#123;</span><br><span class="line">                        Q.push(v);</span><br><span class="line">                        vis[v]=<span class="number">1</span>; f[v]=f[x]+<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span> (v==E) <span class="keyword">return</span> f[v];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            s++;</span><br><span class="line">            tmp/=<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; i++)&#123;</span><br><span class="line">        S=S*<span class="number">2</span>+gett()-<span class="string">'0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; i++)&#123;</span><br><span class="line">        E=E*<span class="number">2</span>+gett()-<span class="string">'0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,bfs());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p><del>å¼ºæƒä¸‹</del>è½¬ç”¨LJOJã€‚ã€‚ã€‚å¯èƒ½æ˜¯è¦æš‚æ—¶å‘Šåˆ«BZOJçš„æ„æ€<br>è§è¯†äº†LJçš„BZOJçš„rootè´¦å·ï¼Œç„¶è€Œç™»è¿›äº†adminåå°å´ä¸ä¼šç”¨ã€‚ã€‚ã€‚<br>æœ€è¿‘çœ‹äº†minionså°±ç”¨å®ƒçš„ç…§ç‰‡å§= =<br>]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="æœç´¢" scheme="http://blog.fractal128.tk/tags/%E6%90%9C%E7%B4%A2/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æœç´¢" scheme="http://blog.fractal128.tk/categories/OI/%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ [ç½‘ç»œæµ24é¢˜] æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜]]></title>
    <link href="http://blog.fractal128.tk/2015/09/04/networkflow3/"/>
    <id>http://blog.fractal128.tk/2015/09/04/networkflow3/</id>
    <published>2015-09-04T03:45:06.000Z</published>
    <updated>2015-09-12T16:28:28.000Z</updated>
    <content type="html"><![CDATA[<p>çªç„¶å‘ç°ä»Šå¤©æ˜¯æˆ‘ç”Ÿæ—¥ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰ï¼Œåªè§‰å¾—è¶Šå¤§è¶Šä¸ä¸­ç”¨äº†ã€‚ã€‚ã€‚<br><a id="more"></a><br>è¿›åº¦æ¡ï¼šï¼ƒï¼ƒï¼ƒï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ 3/24  </p>
<p>é¢˜ç›®é“¾æ¥<a href="http://cojs.tk/cogs/problem/problem.php?pid=728" target="_blank" rel="external">ğŸ”—</a></p>
<h2 id="Description">Description</h2><p>ç»™å®šæœ‰å‘å›¾G=(V,E)ã€‚è®¾Pæ˜¯Gçš„ä¸€ä¸ªç®€å•è·¯ï¼ˆé¡¶ç‚¹ä¸ç›¸äº¤ï¼‰çš„é›†åˆã€‚å¦‚æœVä¸­æ¯ä¸ª<br>é¡¶ç‚¹æ°å¥½åœ¨Pçš„ä¸€æ¡è·¯ä¸Šï¼Œåˆ™ç§°Pæ˜¯Gçš„ä¸€ä¸ªè·¯å¾„è¦†ç›–ã€‚Pä¸­è·¯å¾„å¯ä»¥ä»Vçš„ä»»ä½•ä¸€ä¸ªé¡¶<br>ç‚¹å¼€å§‹ï¼Œé•¿åº¦ä¹Ÿæ˜¯ä»»æ„çš„ï¼Œç‰¹åˆ«åœ°ï¼Œå¯ä»¥ä¸º0ã€‚Gçš„æœ€å°è·¯å¾„è¦†ç›–æ˜¯Gçš„æ‰€å«è·¯å¾„æ¡æ•°æœ€å°‘<br>çš„è·¯å¾„è¦†ç›–ã€‚<br>è®¾è®¡ä¸€ä¸ªæœ‰æ•ˆç®—æ³•æ±‚ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾Gçš„æœ€å°è·¯å¾„è¦†ç›–ã€‚</p>
<h2 id="Solution">Solution</h2><p>å…¶å®æ˜¯åšè¿‡ç±»ä¼¼çš„é¢˜ç›®çš„ï¼Œè¿™é¢˜åªæ˜¯<a href="http://blog.fractal128.tk/2015/08/16/riverç¥­ç¥€/">ç¥­ç¥€</a>çš„å­é—®é¢˜è€Œå·²ã€‚ã€‚ã€‚<br>å°†æ¯ä¸ªæ‹†ç‚¹ï¼Œå¯¹äºè¾¹(u,v)ï¼Œåªéœ€è¦è¿æ¥äºŒåˆ†å›¾ä¸­çš„(u,vâ€™)ï¼Œç„¶åç›´æ¥åšæœ€å¤§åŒ¹é…å³å¯å¾—åˆ°ç­”æ¡ˆã€‚  </p>
<h2 id="Code">Code</h2><p>ps.è¿™é¢˜ä½¿ç”¨ç½‘ç»œæµå’ŒåŒˆç‰™åˆ©å…¶å®éƒ½å¯ä»¥ï¼»æˆ‘å°±ç”¨äº†æ›´çŸ­çš„åŒˆç‰™åˆ©<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">14000</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,ans,size;</span><br><span class="line"><span class="keyword">int</span> p[maxn],fir[maxn],nex[maxn],b[maxn],q[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>) &#123;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>) &#123; x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    b[++size]=y; nex[size]=fir[x]; fir[x]=size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">hungray</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u=fir[x]; u; u=nex[u])&#123;</span><br><span class="line">        <span class="keyword">int</span> v=b[u];</span><br><span class="line">        <span class="keyword">if</span> (!vis[v])&#123;</span><br><span class="line">            vis[v]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (p[v]==<span class="number">0</span>||hungray(p[v]))&#123;</span><br><span class="line">                p[v]=x; q[x]=v; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n=read(); m=read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;</span><br><span class="line">        x=read(); y=read();</span><br><span class="line">        add(x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">if</span> (hungray(i)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"%d"</span>, i); <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> k=i; </span><br><span class="line">        <span class="keyword">while</span> (q[k]!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>, q[k]);</span><br><span class="line">            k=q[k];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        sum++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Update<br>ç¬¬ä¸€æ¬¡çœ‹è§ç”Ÿæ—¥å¿«ä¹ç‰ˆçš„googleï¼Œå¥½å¥½ä¿å­˜ã€‚ã€‚ã€‚<br><img src="http://7xl5lt.com1.z0.glb.clouddn.com/å±å¹•å¿«ç…§%202015-09-04%20ä¸‹åˆ10.50.52.png" alt="å†çœ‹åˆ°çš„è¯å°±æˆå‡†é«˜ä¸‰ç‹—äº†ã€‚ã€‚ã€‚
"></p>]]></content>
    <summary type="html">
    <![CDATA[<p>çªç„¶å‘ç°ä»Šå¤©æ˜¯æˆ‘ç”Ÿæ—¥ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰ï¼Œåªè§‰å¾—è¶Šå¤§è¶Šä¸ä¸­ç”¨äº†ã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="äºŒåˆ†å›¾" scheme="http://blog.fractal128.tk/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/categories/OI/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[[ç½‘ç»œæµ24é¢˜] å¤ªç©ºé£è¡Œè®¡åˆ’]]></title>
    <link href="http://blog.fractal128.tk/2015/09/03/networkflow2/"/>
    <id>http://blog.fractal128.tk/2015/09/03/networkflow2/</id>
    <published>2015-09-03T15:44:07.000Z</published>
    <updated>2015-09-03T16:21:54.000Z</updated>
    <content type="html"><![CDATA[<p>å»¶ç»­ä½æ•ˆå•ƒé¢˜ä¼ ç»Ÿï¼Œåˆæ˜¯ä¸€ä¸ªä¸‹åˆï¼Œè°ƒäº†åŠå¤©æ‰å‘ç°è‡ªå·±ä¸ä¼šæ±‚æœ€å°å‰²æ–¹æ¡ˆã€‚ã€‚ã€‚<br><a id="more"></a><br>è¿›åº¦æ¡ï¼šï¼ƒï¼ƒï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ 2/24</p>
<p>é¢˜ç›®é“¾æ¥<a href="http://cojs.tk/cogs/problem/problem.php?pid=727" target="_blank" rel="external">æˆ³è¿™é‡Œ</a></p>
<h2 id="Description">Description</h2><p>W æ•™æˆæ­£åœ¨ä¸ºå›½å®¶èˆªå¤©ä¸­å¿ƒè®¡åˆ’ä¸€ç³»åˆ—çš„å¤ªç©ºé£è¡Œã€‚æ¯æ¬¡å¤ªç©ºé£è¡Œå¯è¿›è¡Œä¸€ç³»åˆ—å•†ä¸šæ€§å®éªŒè€Œè·å–åˆ©æ¶¦ã€‚ç°å·²ç¡®å®šäº†ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„å®éªŒé›†åˆE={E1,E2,â€¦,Em}ï¼Œå’Œè¿›è¡Œè¿™äº›å®éªŒéœ€è¦ä½¿ç”¨çš„å…¨éƒ¨ä»ªå™¨çš„é›†åˆI={ I1, I2,â€¦,In }ã€‚å®éªŒEj éœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯Içš„å­é›†RjâˆˆIã€‚é…ç½®ä»ªå™¨Ik çš„è´¹ç”¨ä¸ºck ç¾å…ƒã€‚å®éªŒEj çš„èµåŠ©å•†å·²åŒæ„ä¸ºè¯¥å®éªŒç»“æœæ”¯ä»˜pj ç¾å…ƒã€‚Wæ•™æˆçš„ä»»åŠ¡æ˜¯æ‰¾å‡ºä¸€ä¸ªæœ‰æ•ˆç®—æ³•ï¼Œç¡®å®šåœ¨ä¸€æ¬¡å¤ªç©ºé£è¡Œä¸­è¦è¿›è¡Œå“ªäº›å®éªŒå¹¶å› æ­¤è€Œé…ç½®å“ªäº›ä»ªå™¨æ‰èƒ½ä½¿å¤ªç©ºé£è¡Œçš„å‡€æ”¶ç›Šæœ€å¤§ã€‚è¿™é‡Œå‡€æ”¶ç›Šæ˜¯æŒ‡è¿›è¡Œå®éªŒæ‰€è·å¾—çš„å…¨éƒ¨æ”¶å…¥ä¸é…ç½®ä»ªå™¨çš„å…¨éƒ¨è´¹ç”¨çš„å·®é¢ã€‚</p>
<h2 id="Solution">Solution</h2><p>ä¸€å¼€å§‹æ ¹æœ¬ä¸ä¼šåšï¼Œçœ‹äº†è®ºæ–‡æ‰å‘ç°è¿™å…¶å®æ˜¯ä¸€ç§æœ€å°å‰²çš„ç»å…¸æ¨¡å‹ã€‚ã€‚å«åšæœ€å¤§æƒé—­åˆå›¾ã€‚ç¨å¾®è§£é‡Šä¸‹æ¨¡å‹çš„è½¬æ¢æ–¹æ³•ï¼Œä¸¥è°¨è¯æ˜ä»¥åŠå„ç§å®šä¹‰å¯ä»¥å‚è§èƒ¡ä¼¯æ¶›è®ºæ–‡<a href="http://wenku.baidu.com/link?url=lfPkq0BOD2L6zby2PSRW48XNjfTmj9Xwyf-gTh2igRs2txeOWq8FPpx43Bd7I9j-j628LlPJPOoCu8cBRdOypSTal_A-6IGs-1aZtqzNMcq" target="_blank" rel="external">æœ€å°å‰²æ¨¡å‹åœ¨ä¿¡æ¯å­¦ç«èµ›ä¸­çš„åº”ç”¨</a><br>åˆæ­¥æ€è€ƒï¼šå°†å„ä¸ªè¯•éªŒå‘ä»–æ‰€éœ€è¦çš„å„ä¸ªå™¨æè¿è¾¹ï¼Œè¿™å¼ å›¾çš„æœ€å¤§æƒé—­åˆå›¾çš„æƒå€¼å°±æ˜¯æ‰€æ±‚çš„ç­”æ¡ˆã€‚ï¼ˆè¡¨ç¤ºå™¨æçš„ç‚¹åº”è¯¥ä¸ºè´Ÿå€¼ï¼‰<br>å…ˆæ¥çœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™é“é¢˜æ˜¯æ±‚æœ€å¤§æƒé—­åˆå›¾</p>
<ul>
<li>å› ä¸ºæ¯ä¸ªè¯•éªŒè¦æ±‚æ‰€æœ‰éœ€è¦å™¨æç¼ºä¸€ä¸å¯ï¼Œæ‰€ä»¥é€‰æ‹©çš„æ¯ä¸ªè¯•éªŒæ‰€è¿å‡ºå»çš„è¾¹éƒ½ä¼šè¢«é€‰æ‹©å…¥è¢«é€‰å­å›¾ï¼Œå³è¯¥å­å›¾ä¸€å®šä¸ºé—­åˆå›¾</li>
<li>é¢˜ç›®è¦æ±‚æœ€å¤§æ”¶ç›Šï¼Œå³æœ€å¤§çš„æ‰€æœ‰çš„è¯•éªŒæ‰€å¾—ï¼å™¨æå¼€æ”¯ï¼Œåˆšå¥½ä¸ºæ‰€æœ‰æ‰€é€‰åˆæ³•å­å›¾ä¸­ç‚¹æƒå€¼å’Œçš„æœ€å¤§å€¼ã€‚</li>
</ul>
<p>å…·ä½“æ–¹æ³•æ˜¯å°†è¯•éªŒ-å™¨æè¾¹çš„å®¹é‡è®¾ä¸ºINF,å¹¶ä¸”ä»æºç‚¹Så‘æ‰€æœ‰è¯•éªŒç‚¹è¿è¾¹ï¼Œå®¹é‡ä¸ºè¯•éªŒæ”¶ç›Šï¼Œç›¸åŒçš„ï¼Œå™¨æç‚¹å’Œæ±‡ç‚¹Tè¿è¾¹ï¼Œå®¹é‡ä¸ºå™¨æå¼€æ”¯çš„ç»å¯¹å€¼ï¼ˆâš æ³¨æ„ï¼‰ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè·‘æœ€å°å‰²ï¼Œæœ€ç»ˆç­”æ¡ˆä¸ºä¸Sç›¸è¿æœªè¢«å‰²å»çš„è¾¹å’Œä¸Tç›¸è¿è¢«å‰²å»çš„è¾¹çš„å®¹é‡å’Œã€‚ã€‚ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">20000</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INF <span class="number">1000000007</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">struct</span> edge&#123;</span><br><span class="line">    <span class="keyword">int</span> cap,to,op,flow;</span><br><span class="line">&#125;e[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cur[maxn],nex[maxn],fir[maxn];</span><br><span class="line"><span class="keyword">int</span> c[maxn],p[maxn];</span><br><span class="line"><span class="keyword">int</span> ans1[maxn],d[maxn],ans2[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="keyword">int</span> n,m,s,t,size,sum;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span></span>&#123;</span><br><span class="line">    e[++size].to=y; e[size].cap=cap; e[size].op=size+<span class="number">1</span>; nex[size]=fir[x]; fir[x]=size;</span><br><span class="line">    e[++size].to=x; e[size].cap=<span class="number">0</span>; e[size].op=size-<span class="number">1</span>; nex[size]=fir[y]; fir[y]=size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;p[x]); add(s,x,p[x]);</span><br><span class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">1</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch!=<span class="string">'\r'</span>&amp;&amp;ch!=<span class="string">'\n'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((ch&gt;<span class="string">'9'</span> || ch&lt;<span class="string">'0'</span>) &amp;&amp; k!=<span class="number">0</span>)&#123;</span><br><span class="line">            add(x,k+n,INF); k=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>) k=k*<span class="number">10</span>+ch-<span class="string">'0'</span>;</span><br><span class="line">        ch=getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k&gt;<span class="number">0</span>) add(x,k+n,INF);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    vis[s]=<span class="number">1</span>; Q.push(s); d[s]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front(); Q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u=fir[x]; u; u=nex[u])&#123;</span><br><span class="line">            <span class="keyword">int</span> v=e[u].to;</span><br><span class="line">            <span class="keyword">if</span> (!vis[v]&amp;&amp;e[u].cap&gt;e[u].flow)&#123;</span><br><span class="line">                vis[v]=<span class="number">1</span>; Q.push(v); d[v]=d[x]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (vis[t]) <span class="keyword">return</span> <span class="literal">true</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x==t||a==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>,f;</span><br><span class="line">    <span class="keyword">while</span> (cur[x]!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> u=cur[x];</span><br><span class="line">        <span class="keyword">if</span> (d[x]+<span class="number">1</span>==d[e[u].to] &amp;&amp; (f=dfs(e[u].to,min(a,e[u].cap-e[u].flow))) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            e[u].flow+=f; e[e[u].op].flow-=f;</span><br><span class="line">            flow+=f;</span><br><span class="line">            a-=f;</span><br><span class="line">            <span class="keyword">if</span> (a==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur[x]=nex[cur[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (bfs())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=n+m+<span class="number">1</span>; i++) cur[i]=fir[i];</span><br><span class="line">        flow += dfs(s,INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    vis[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u=fir[x]; u; u=nex[u])&#123;</span><br><span class="line">        <span class="keyword">int</span> v=e[u].to;</span><br><span class="line">        <span class="keyword">if</span> (!vis[v]&amp;&amp;e[u].cap&gt;e[u].flow) Dfs(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">    Dfs(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=size; i++) </span><br><span class="line">    <span class="keyword">if</span> (e[i].cap&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> y=e[i].to,x=e[e[i].op].to;</span><br><span class="line">        <span class="keyword">if</span> ((vis[x]^vis[y])==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (y==t) &#123;sum-=e[i].cap, ans2[++ans2[<span class="number">0</span>]]=x;&#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (x==s) &#123;sum+=e[i].cap, ans1[++ans1[<span class="number">0</span>]]=y;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ans1+<span class="number">1</span>,ans1+<span class="number">1</span>+ans1[<span class="number">0</span>]); sort(ans2+<span class="number">1</span>,ans2+<span class="number">1</span>+ans2[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=ans1[<span class="number">0</span>]; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans1[i]); <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=ans2[<span class="number">0</span>]; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans2[i]-n); <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    s=<span class="number">0</span>; t=n+m+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        read(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=m; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;c[i]);</span><br><span class="line">        add(i+n,t,c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    dinic();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>å»¶ç»­ä½æ•ˆå•ƒé¢˜ä¼ ç»Ÿï¼Œåˆæ˜¯ä¸€ä¸ªä¸‹åˆï¼Œè°ƒäº†åŠå¤©æ‰å‘ç°è‡ªå·±ä¸ä¼šæ±‚æœ€å°å‰²æ–¹æ¡ˆã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="æœ€å¤§æµ" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/"/>
    
      <category term="æœ€å°å‰²" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%B0%8F%E5%89%B2/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/categories/OI/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ [ç½‘ç»œæµ24é¢˜] æ­é…é£è¡Œå‘˜]]></title>
    <link href="http://blog.fractal128.tk/2015/09/03/network-flow1/"/>
    <id>http://blog.fractal128.tk/2015/09/03/network-flow1/</id>
    <published>2015-09-03T06:10:55.000Z</published>
    <updated>2015-09-03T16:20:43.000Z</updated>
    <content type="html"><![CDATA[<p>ç¨å¾®å¤ä¹ äº†ä¸‹ç½‘ç»œæµå‘ç°æ ¹æœ¬ä¸ä¼šå†™äº†ï¼»çª˜ã€‚ã€‚ã€‚<br>æ‰¾åˆ°äº†è¿™ä¸ªä¼ å¥‡çš„24é¢˜ç¥å‘,æ„Ÿè§‰åƒæ˜¯ç«‹ä¸‹äº†æœªæ¥å…¨Aè¿™24é¢˜çš„flag<br><a id="more"></a><br>è¿›åº¦æ¡ï¼šï¼ƒï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ 1/24</p>
<p>åœ¨çº¿æäº¤æ¥è‡ª<a href="http://cojs.tk/cogs/problem/problem.php?pid=14" target="_blank" rel="external">cojs.tk</a></p>
<h2 id="Description">Description</h2><p>é£è¡Œå¤§é˜Ÿæœ‰è‹¥å¹²ä¸ªæ¥è‡ªå„åœ°çš„é©¾é©¶å‘˜ï¼Œä¸“é—¨é©¾é©¶ä¸€ç§å‹å·çš„é£æœºï¼Œè¿™ç§é£æœºæ¯æ¶æœ‰ä¸¤ä¸ªé©¾é©¶å‘˜,éœ€ä¸€ä¸ªæ­£é©¾é©¶å‘˜å’Œä¸€ä¸ªå‰¯é©¾é©¶å‘˜ã€‚ç”±äºç§ç§åŸå› ï¼Œä¾‹å¦‚ç›¸äº’é…åˆçš„é—®é¢˜ï¼Œæœ‰äº›é©¾é©¶å‘˜ä¸èƒ½åœ¨åŒä¸€æ¶é£æœºä¸Šé£è¡Œï¼Œé—®å¦‚ä½•æ­é…é©¾é©¶å‘˜æ‰èƒ½ä½¿å‡ºèˆªçš„é£æœºæœ€å¤šã€‚</p>
<h2 id="Solution">Solution</h2><p>æ ‡å‡†äºŒåˆ†å›¾åŒ¹é…ï¼Œæ²¡å†™åŒˆç‰™åˆ©åªæ˜¯ä¸ºäº†ç»ƒä¸€ç»ƒdinic<br>åŸç‚¹Så’Œæ¯ä¸ªæ­£é©¾é©¶å‘˜è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œæ±‡ç‚¹å’Œå‰¯é©¾é©¶å‘˜è¿ï¼Œç„¶åæ­£å‰¯ä¹‹é—´ä¹Ÿè¿ä¸€è¿ã€‚ã€‚ã€‚ç„¶åéšæ„çš„å†™ä¸€ä¸ªæœ€å¤§æµï¼»æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ æˆ‘è°ƒäº†åŠä¸ªå°æ—¶</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxm <span class="number">1000</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">500</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INF <span class="number">1000000007</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">struct</span> edge</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> to,cap,flow,op;</span><br><span class="line">&#125;e[maxm];</span><br><span class="line"><span class="keyword">int</span> fir[maxn],nex[maxm],cur[maxn],d[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="keyword">int</span> n,m,size,s,t;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>) ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>) &#123; x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap)</span></span>&#123;</span><br><span class="line">    e[++size].to=y; e[size].cap=cap; e[size].op=size+<span class="number">1</span>; nex[size]=fir[x]; fir[x]=size;</span><br><span class="line">    e[++size].to=x; e[size].cap=<span class="number">0</span>; e[size].op=size-<span class="number">1</span>; nex[size]=fir[y]; fir[y]=size;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    vis[s]=<span class="number">1</span>; Q.push(s); d[s]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x=Q.front(); Q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u=fir[x]; u; u=nex[u])&#123;</span><br><span class="line">            <span class="keyword">int</span> v=e[u].to;</span><br><span class="line">            <span class="keyword">if</span> (!vis[v]&amp;&amp;e[u].cap&gt;e[u].flow)&#123;</span><br><span class="line">                vis[v]=<span class="number">1</span>; Q.push(v); d[v]=d[x]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (vis[t]) <span class="keyword">return</span> <span class="literal">true</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x==t||a==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>,f;</span><br><span class="line">    <span class="keyword">while</span> (cur[x]!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> u=cur[x];</span><br><span class="line">        <span class="keyword">if</span> (d[x]+<span class="number">1</span>==d[e[u].to] &amp;&amp; (f=dfs(e[u].to,min(a,e[u].cap-e[u].flow))) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            e[u].flow+=f; e[e[u].op].flow-=f;</span><br><span class="line">            flow+=f;</span><br><span class="line">            a-=f;</span><br><span class="line">            <span class="keyword">if</span> (a==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur[x]=nex[cur[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (bfs())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=n+<span class="number">1</span>; i++) cur[i]=fir[i];</span><br><span class="line">        flow += dfs(s,INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    s=<span class="number">0</span>; t=n+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y)==<span class="number">2</span>)&#123;</span><br><span class="line">        add(x,y,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i&gt;m) add(i,t,<span class="number">1</span>); <span class="keyword">else</span> add(s,i,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dinic());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>ç¨å¾®å¤ä¹ äº†ä¸‹ç½‘ç»œæµå‘ç°æ ¹æœ¬ä¸ä¼šå†™äº†ï¼»çª˜ã€‚ã€‚ã€‚<br>æ‰¾åˆ°äº†è¿™ä¸ªä¼ å¥‡çš„24é¢˜ç¥å‘,æ„Ÿè§‰åƒæ˜¯ç«‹ä¸‹äº†æœªæ¥å…¨Aè¿™24é¢˜çš„flag<br>]]>
    
    </summary>
    
      <category term="æœ€å¤§æµ" scheme="http://blog.fractal128.tk/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="ç½‘ç»œæµ" scheme="http://blog.fractal128.tk/categories/OI/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[BZOJ3110:[Zjoi2013]Kå¤§æ•°æŸ¥è¯¢]]></title>
    <link href="http://blog.fractal128.tk/2015/09/03/bzoj3110/"/>
    <id>http://blog.fractal128.tk/2015/09/03/bzoj3110/</id>
    <published>2015-09-02T17:42:48.000Z</published>
    <updated>2015-09-03T04:31:13.000Z</updated>
    <content type="html"><![CDATA[<p>è¯´æ˜¯æ ‘å¥—æ ‘è£¸é¢˜ï¼Œç„¶è€Œè¿çº¿æ®µæ ‘éƒ½æ‰“ä¸ç†Ÿçš„æˆ‘æ€ä¹ˆå¯èƒ½ä¼šèƒ½ï¼Œæ„Ÿè§‰çœŸçš„å¥½è…»å®³çš„æ ·å­ï¼Œä»æ˜¨å¤©å’ŒHanTYä¸€èµ·å­¦ï¼Œåˆ°ä»Šå¤©å†™å‡ºæ¥ï¼Œå†åŠ ä¸€å †è°ƒè¯•ï¼Œç»ˆäºã€‚ã€‚ã€‚<a id="more"></a></p>
<p>é“¾æ¥<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3110" target="_blank" rel="external">æˆ³è¿™</a></p>
<h2 id="Description">Description</h2><p>æœ‰Nä¸ªä½ç½®ï¼ŒMä¸ªæ“ä½œã€‚æ“ä½œæœ‰ä¸¤ç§ï¼Œæ¯æ¬¡æ“ä½œå¦‚æœæ˜¯1 a b cçš„å½¢å¼è¡¨ç¤ºåœ¨ç¬¬aä¸ªä½ç½®åˆ°ç¬¬bä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®åŠ å…¥ä¸€ä¸ªæ•°c;å¦‚æœæ˜¯2 a b cå½¢å¼ï¼Œè¡¨ç¤ºè¯¢é—®ä»ç¬¬aä¸ªä½ç½®åˆ°ç¬¬bä¸ªä½ç½®ï¼Œç¬¬Cå¤§çš„æ•°æ˜¯å¤šå°‘ã€‚</p>
<h2 id="Solution">Solution</h2><p>æ–¹æ³•å¥½åƒå¾ˆå¤šã€‚ã€‚ã€‚ï¼»æ„Ÿè§‰æˆ‘å­¦çš„æ˜¯æœ€<ruby>åŸºç¡€<rp> (</rp><rt>shuÇ shuÇ</rt><rp>) </rp></ruby>çš„<br>å¤–å±‚æ ‘ç»´æŠ¤æ¯ä¸€ç§ä¸åŒçš„æƒå€¼ï¼Œå†…å±‚æ ‘ç»´æŠ¤åŒºé—´èŒƒå›´ï¼Œè®¡ç®—ç­”æ¡ˆçš„æ—¶å€™ç”¨äºŒåˆ†æšä¸¾ç­”æ¡ˆï¼Œç„¶åæ¯æ¬¡è°ƒç”¨æ¥æ±‚ï¼»æšä¸¾çš„ç­”æ¡ˆ,æƒå€¼çš„æœ€å¤§å€¼(=n)ï¼½è¿™ä¸€æ®µä¸­ï¼Œä½äºæ‰€æ±‚åŒºé—´[a,b]æ®µçš„å…ƒç´ çš„ä¸ªæ•°ã€‚</p>
<h2 id="Code">Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> maxn <span class="number">20000007</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123; <span class="keyword">if</span> (ch==<span class="string">'-'</span>) f=-<span class="number">1</span>; ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span> (ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;</span><br><span class="line">        x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>; ch=getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lazy[maxn],ls[maxn],rs[maxn],sum[maxn],root[maxn];</span><br><span class="line"><span class="keyword">int</span> n,m,size;</span><br><span class="line"><span class="keyword">int</span> o,a,b,c;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!lazy[k]||l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (ls[k]==<span class="number">0</span>) ls[k]=++size;</span><br><span class="line">    <span class="keyword">if</span> (rs[k]==<span class="number">0</span>) rs[k]=++size;</span><br><span class="line">    lazy[ls[k]]+=lazy[k]; lazy[rs[k]]+=lazy[k];</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    sum[ls[k]]+=(mid-l+<span class="number">1</span>)*lazy[k];</span><br><span class="line">    sum[rs[k]]+=(r-mid)*lazy[k];</span><br><span class="line">    lazy[k]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mod</span><span class="params">(<span class="keyword">int</span> &amp;k,<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> a, <span class="keyword">int</span> b,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k==<span class="number">0</span>) k=++size;</span><br><span class="line">    pushdown(k,l,r);</span><br><span class="line">    <span class="keyword">if</span> (a&lt;=l&amp;&amp;r&lt;=b)&#123;</span><br><span class="line">        sum[k]+=r-l+<span class="number">1</span>;</span><br><span class="line">        lazy[k]+=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (a&lt;=mid) mod(ls[k],l,mid,a,b,x);</span><br><span class="line">    <span class="keyword">if</span> (mid&lt;b) mod(rs[k],mid+<span class="number">1</span>,r,a,b,x);</span><br><span class="line">    sum[k]=sum[ls[k]]+sum[rs[k]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> c,<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l=<span class="number">1</span>,r=n,k=<span class="number">1</span>;</span><br><span class="line">    mod(root[k],<span class="number">1</span>,n,a,b,k);</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (mid&lt;c)&#123;</span><br><span class="line">            k=k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</span><br><span class="line">            mod(root[k],<span class="number">1</span>,n,a,b,k);</span><br><span class="line">            l=mid+<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            k=k&lt;&lt;<span class="number">1</span>;</span><br><span class="line">            mod(root[k],<span class="number">1</span>,n,a,b,k);</span><br><span class="line">            r=mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    pushdown(k,l,r);</span><br><span class="line">    <span class="keyword">if</span> (a&lt;=l&amp;&amp;r&lt;=b)&#123;</span><br><span class="line">        <span class="keyword">return</span> sum[k];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret=<span class="number">0</span>,mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (a&lt;=mid) ret+=get_sum(ls[k],l,mid,a,b);</span><br><span class="line">    <span class="keyword">if</span> (mid&lt;b) ret+=get_sum(rs[k],mid+<span class="number">1</span>,r,a,b); </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l=<span class="number">1</span>,r=n,t=c,k=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">        <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> tmp=get_sum(root[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>],<span class="number">1</span>,n,a,b);</span><br><span class="line">        <span class="keyword">if</span> (tmp&lt;t)&#123;</span><br><span class="line">            t-=tmp; k&lt;&lt;=<span class="number">1</span>; r=mid;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            k=k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>; l=mid+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n=read(); m=read();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=m; i++)&#123;</span><br><span class="line">        o=read(); a=read(); b=read(); c=read();</span><br><span class="line">        <span class="keyword">if</span> (o==<span class="number">1</span>) insert(c,a,b);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(a,b,c));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>è¯´æ˜¯æ ‘å¥—æ ‘è£¸é¢˜ï¼Œç„¶è€Œè¿çº¿æ®µæ ‘éƒ½æ‰“ä¸ç†Ÿçš„æˆ‘æ€ä¹ˆå¯èƒ½ä¼šèƒ½ï¼Œæ„Ÿè§‰çœŸçš„å¥½è…»å®³çš„æ ·å­ï¼Œä»æ˜¨å¤©å’ŒHanTYä¸€èµ·å­¦ï¼Œåˆ°ä»Šå¤©å†™å‡ºæ¥ï¼Œå†åŠ ä¸€å †è°ƒè¯•ï¼Œç»ˆäºã€‚ã€‚ã€‚]]>
    
    </summary>
    
      <category term="BZOJ" scheme="http://blog.fractal128.tk/tags/BZOJ/"/>
    
      <category term="ZJOI" scheme="http://blog.fractal128.tk/tags/ZJOI/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="http://blog.fractal128.tk/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="OI" scheme="http://blog.fractal128.tk/categories/OI/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="http://blog.fractal128.tk/categories/OI/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[è®°æš‘å‡ä¹‹é¢“]]></title>
    <link href="http://blog.fractal128.tk/2015/08/30/%E8%AE%B0%E6%9A%91%E5%81%87%E4%B9%8B%E9%A2%93/"/>
    <id>http://blog.fractal128.tk/2015/08/30/è®°æš‘å‡ä¹‹é¢“/</id>
    <published>2015-08-29T19:19:46.000Z</published>
    <updated>2015-08-30T15:21:22.000Z</updated>
    <content type="html"><![CDATA[<p>ç°åœ¨å·²ç»æ˜¯8æœˆ30æ—¥ï¼Œæš‘å‡çš„æœ€åä¸€å¤©?<br>ç´¯è§‰ä¸çˆ±å•Šã€‚ã€‚ã€‚<br><a id="more"></a><br>ä¸‹é¢å¼€å§‹æ¸…ç‚¹æœªå®Œæˆä¹‹æš‘å‡ä½œä¸š<br>ï¼ï¼ï¼ï¼ï¼ï¼ç”»é£çªå˜çš„åˆ†å‰²çº¿ï¼ï¼ï¼ï¼ï¼ï¼</p>
<ul>
<li>NCEè¿˜æœ‰4è¯¾æ²¡èƒŒï¼Œï¼»æ®å¼€å­¦è¿˜æœ‰ä¸ª20å¤šå°æ—¶ä½ çœ‹ç€åŠå•Š</li>
<li>å¬è¯´è‹±è¯­å¼€å­¦æ£€æµ‹ï¼Œä»€ä¹ˆå•è¯ä»€ä¹ˆçš„å¥½åƒæ ¹æœ¬ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚ã€‚ã€‚</li>
<li>å¥½å·§å•Šï¼Œè¯­æ–‡ç»„å¥½åƒä¹Ÿå‘äº†çŸ­ä¿¡è¯´è¦è€ƒè¯•å•Šï¼</li>
<li>æ›´é‡è¦çš„ï¼Œå†å²åœ°ç†å­¦è€ƒäº†ä¸€ç‚¹éƒ½æ²¡å¤ä¹ å•Šï¼Œè™šæ­»ï¼ ï¼</li>
<li>NOIPé©¬ä¸Šè€ƒè¯•ï¼Œè€ƒä¸å¥½å°±æ»šç²—äº†ï¼Œå¬è¯´é«˜ä¸€æ¥äº†ä¸ªåˆä¸€çº¢åçˆ·ï¼Œæ„Ÿè§‰è†ç›–å·²ä¸æ˜¯æˆ‘çš„</li>
</ul>
<p>æ„Ÿè§‰æš‘å‡çœŸçš„æ²¡åšä»€ä¹ˆå•Šï¼Œè¿™ç§åƒæ˜¯å¾—äº†å¤±å¿†çš„æ„Ÿè§‰çœŸæ˜¯å¤ª<ruby>å¥‡å¦™<rp> (</rp><rt>cÄo dÃ n</rt><rp>) </rp></ruby>äº†ã€‚  </p>
<p>å¿ƒç´¯ã€‚ã€‚ã€‚æ´—æ´—ç¡äº†[æ˜å¤©é¢„è®¡ç¡åˆ°12ç‚¹ï¼ŒNCEæ€ä¹ˆåŠ!!!</p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=210284&auto=1&height=66"></iframe>

<p>[UPD date:Aug.30 23:15:48]æˆåŠŸèƒŒå®ŒNCEï¼Œå‰é¢èƒŒçš„å…¨å¿˜å…‰äº†ä¹Ÿç®—çš„è¯ã€‚ã€‚ã€‚<br>Anyway,the deadline is comingã€‚ã€‚ã€‚</p>]]></content>
    <summary type="html">
    <![CDATA[<p>ç°åœ¨å·²ç»æ˜¯8æœˆ30æ—¥ï¼Œæš‘å‡çš„æœ€åä¸€å¤©?<br>ç´¯è§‰ä¸çˆ±å•Šã€‚ã€‚ã€‚<br>]]>
    
    </summary>
    
      <category term="é¢å£åçœ" scheme="http://blog.fractal128.tk/tags/%E9%9D%A2%E5%A3%81%E5%8F%8D%E7%9C%81/"/>
    
      <category term="éšè®°" scheme="http://blog.fractal128.tk/categories/%E9%9A%8F%E8%AE%B0/"/>
    
  </entry>
  
</feed>
