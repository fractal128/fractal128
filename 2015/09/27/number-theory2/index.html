<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>åˆç­‰æ•°è®ºï¼ˆäºŒï¼‰ | Fractal128 ï¼š We are OIers</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <meta name="description" content="ä¸­ç§‹å¿«ä¹ï¼ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="åˆç­‰æ•°è®ºï¼ˆäºŒï¼‰">
<meta property="og:url" content="http://blog.fractal128.tk/2015/09/27/number-theory2/index.html">
<meta property="og:site_name" content="Fractal128 ï¼š We are OIers">
<meta property="og:description" content="ä¸­ç§‹å¿«ä¹ï¼ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚">
<meta property="og:updated_time" content="2015-10-04T16:15:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="åˆç­‰æ•°è®ºï¼ˆäºŒï¼‰">
<meta name="twitter:description" content="ä¸­ç§‹å¿«ä¹ï¼ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚">
  
  
    <link rel="icon" href="http://blog.fractal128.tk/css/images/f1.ico">
  
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  <!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-66886955-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
  
  
</head></html>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/f2.jpg)"></i><span class="site-title">Fractal128 ï¼š We are OIers</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/1.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <!--
      <div id="search-form-wrap">
        
      </div>  -->
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">Home</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          
        </td>
      </tr>
    </table>
  </div>


  <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','J4tnoiVdAE4QCHwjTT9U','2.0.0');
</script>
</header>
    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/1.jpg">
      <h2 id="name">fractal128</h2>
      <h3 id="title">if not me, who, if not now, when.</h3>
      <span id="location"><i class="fa fa-map-marker"></i>HangZhou, China</span>
      <a id="follow" href="https://gitcafe.com/fractal128/">FOLLOW</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        28
        <span>posts</span>
      </div>
      <div class="article-info-block">
        31
        <span>tags</span>
      </div>
    </div>

    <div class="article-info profile-block">
    	  <script type="text/javascript" src="http://www.xiami.com/widget/player-multi?uid=55528284&sid=1771977511,2073511,1770182616,1770554728,1770776542,1769876919,2051509,&width=260&height=346&mainColor=40B6E8&backColor=ffffff&autoplay=0&mode=js"></script>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="https://github.com/fractal128" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/#" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="https://www.facebook.com/profile.php?id=100008201833794" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>

    
</aside>
      
      <section id="main"><article id="post-number-theory2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <img src="http://7xl5lt.com1.z0.glb.clouddn.com/moon.jpeg" class="article-banner">
    
    
    
      <header class="article-header">
        <h1 class="article-title" itemprop="name">
      åˆç­‰æ•°è®ºï¼ˆäºŒï¼‰
    </h1>
        <div class="article-meta">
          <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2015/09/27/number-theory2/">
      <time datetime="2015-09-27T07:11:45.000Z" itemprop="datePublished">2015-09-27</time>
    </a>
  </div>
          <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ•°è®º/">æ•°è®º</a>
  </div>
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <div id="toc" class="toc-article">
        <!--<strong class="toc-title">Catalogue</strong>-->
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆç­‰æ•°è®º"><span class="toc-number">1.</span> <span class="toc-text">åˆç­‰æ•°è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æ•°è®ºç­›æ³•"><span class="toc-number">1.1.</span> <span class="toc-text">æ•°è®ºç­›æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Eraosthensç­›æ³•"><span class="toc-number">1.1.1.</span> <span class="toc-text">Eraosthensç­›æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)"><span class="toc-number">1.1.2.</span> <span class="toc-text">çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¸¸ç”¨æ€§è´¨"><span class="toc-number">1.1.3.</span> <span class="toc-text">å¸¸ç”¨æ€§è´¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç´ æ•°æµ‹è¯•"><span class="toc-number">1.2.</span> <span class="toc-text">ç´ æ•°æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fermatç´ æ•°æµ‹è¯•"><span class="toc-number">1.2.1.</span> <span class="toc-text">Fermatç´ æ•°æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è´¹é©¬å°å®šç†"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">è´¹é©¬å°å®šç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¯æ˜"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">è¯æ˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é™åˆ¶ä¸ä¼ªç´ æ•°"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">é™åˆ¶ä¸ä¼ªç´ æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Miller-Rabin_ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹"><span class="toc-number">1.2.2.</span> <span class="toc-text">Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®è·µ"><span class="toc-number">1.2.3.</span> <span class="toc-text">å®è·µ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è´¨å› æ•°åˆ†è§£æ³•"><span class="toc-number">1.3.</span> <span class="toc-text">è´¨å› æ•°åˆ†è§£æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#O(sqrt(n))æš´åŠ›åˆ†è§£"><span class="toc-number">1.3.1.</span> <span class="toc-text">O(sqrt(n))æš´åŠ›åˆ†è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•"><span class="toc-number">1.3.2.</span> <span class="toc-text">Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•</span></a></li></ol></li></ol></li></ol>
    </div>
    
        <p>ä¸­ç§‹å¿«ä¹ï¼<br>ç»§ç»­å¡«å‘å–½ã€‚ã€‚ã€‚<br><a id="more"></a></p>
<h1 id="åˆç­‰æ•°è®º">åˆç­‰æ•°è®º</h1><h2 id="æ•°è®ºç­›æ³•">æ•°è®ºç­›æ³•</h2><h3 id="Eraosthensç­›æ³•">Eraosthensç­›æ³•</h3><p>åŸºæœ¬ç­›æ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¸ä¼šè¢«å¡ï¼Œæ—¶é—´å¤æ‚åº¦Î˜(nlogn)[æˆ‘ä¸ä¼šç®—ã€‚ã€‚ã€‚</p>
<h3 id="çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)">çº¿æ€§ç­›æ³•(ç§¯æ€§å‡½æ•°)</h3><p>æ—¶é—´å¤æ‚åº¦Î˜(n)[è¿˜æ˜¯ä¸ä¼šç®—ã€‚ã€‚ã€‚<br>ç›´æ¥æ”¾ä»£ç ã€‚ã€‚ã€‚<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=i;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!mindiv[i])prime[++tot]=mindiv[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=tot&amp;&amp;prime[j]&lt;=mindiv[i]&amp;&amp;(k=prime[j]*i)&lt;=n;j++)</span><br><span class="line">    mindiv[k]=prime[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//mindiv[k]è¡¨ç¤ºkçš„æœ€å°è´¨å› æ•°ï¼Œè¿™æ ·ä¿è¯äº†æ¯ä¸€ä¸ªæ•°åªä¼šè¢«ä»–çš„æœ€å°è´¨å› æ•°ç­›æ‰ä¸€éã€‚</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å¸¸ç”¨æ€§è´¨">å¸¸ç”¨æ€§è´¨</h3><p>nä»¥å†…ç´ æ•°ä¸ªæ•°O(n/ln(n))</p>
<h2 id="ç´ æ•°æµ‹è¯•">ç´ æ•°æµ‹è¯•</h2><h3 id="Fermatç´ æ•°æµ‹è¯•">Fermatç´ æ•°æµ‹è¯•</h3><h4 id="è´¹é©¬å°å®šç†">è´¹é©¬å°å®šç†</h4><blockquote>
<p>å¯¹äºç´ æ•°pä¸ä»»æ„ä¸päº’ç´ çš„æ•´æ•°aæ»¡è¶³a(p-1) â‰¡1(mod p)</p>
</blockquote>
<h4 id="è¯æ˜">è¯æ˜</h4><blockquote><p>è¿™ä¸ªè¯æ˜å°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚<br>    é¦–å…ˆæˆ‘ä»¬è¯æ˜è¿™æ ·ä¸€ä¸ªç»“è®ºï¼šå¦‚æœpæ˜¯ä¸€ä¸ªç´ æ•°çš„è¯ï¼Œé‚£ä¹ˆå¯¹ä»»æ„ä¸€ä¸ªå°äºpçš„æ­£æ•´æ•°aï¼Œa, 2a, 3a, â€¦, (p-1)aé™¤ä»¥pçš„ä½™æ•°æ­£å¥½æ˜¯ä¸€ä¸ª1åˆ°p-1çš„æ’åˆ—ã€‚ä¾‹å¦‚ï¼Œ5æ˜¯ç´ æ•°ï¼Œ3, 6, 9, 12é™¤ä»¥5çš„ä½™æ•°åˆ†åˆ«ä¸º3, 1, 4, 2ï¼Œæ­£å¥½å°±æ˜¯1åˆ°4è¿™å››ä¸ªæ•°ã€‚<br>    åè¯æ³•ï¼Œå‡å¦‚ç»“è®ºä¸æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯è¯´æœ‰ä¸¤ä¸ªå°äºpçš„æ­£æ•´æ•°må’Œnä½¿å¾—naå’Œmaé™¤ä»¥pçš„ä½™æ•°ç›¸åŒã€‚ä¸å¦¨å‡è®¾n&gt;mï¼Œåˆ™på¯ä»¥æ•´é™¤a(n-m)ã€‚ä½†pæ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆaå’Œn-mä¸­è‡³å°‘æœ‰ä¸€ä¸ªå«æœ‰å› å­pã€‚è¿™æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºaå’Œn-méƒ½æ¯”på°ã€‚<br>    ç”¨åŒä½™å¼è¡¨è¿°ï¼Œæˆ‘ä»¬è¯æ˜äº†ï¼š<br>(p-1)! â‰¡ a * 2a * 3a * â€¦ * (p-1)a (mod p)<br>    ä¹Ÿå³ï¼š<br>(p-1)! â‰¡ (p-1)! * a^(p-1) (mod p)<br>    ä¸¤è¾¹åŒæ—¶é™¤ä»¥(p-1)!ï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬çš„æœ€ç»ˆç»“è®ºï¼š<br>1 â‰¡ a^(p-1) (mod p)</p><footer><strong>Matrix67</strong><cite><a href="http://www.matrix67.com/blog/archives/234" target="_blank" rel="external">æ•°è®ºéƒ¨åˆ†ç¬¬ä¸€èŠ‚ï¼šç´ æ•°ä¸ç´ æ€§æµ‹è¯•</a></cite></footer></blockquote>
<h4 id="é™åˆ¶ä¸ä¼ªç´ æ•°">é™åˆ¶ä¸ä¼ªç´ æ•°</h4><blockquote><p>è°ˆåˆ°Fermatå°å®šç†ï¼Œæ•°å­¦å†å²ä¸Šæœ‰å¾ˆå¤šè¯¯è§£ã€‚å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œäººä»¬éƒ½è®¤ä¸ºFermatå°å®šç†çš„é€†å‘½é¢˜æ˜¯æ­£ç¡®çš„ï¼Œå¹¶ä¸”æœ‰äººäº²è‡ªéªŒè¯äº†a=2, p&lt;300çš„æ‰€æœ‰æƒ…å†µã€‚å›½å¤–ç”šè‡³æµä¼ ç€ä¸€ç§è¯´æ³•ï¼Œè®¤ä¸ºä¸­å›½åœ¨å­”å­æ—¶ä»£å°±è¯æ˜äº†è¿™æ ·çš„å®šç†ï¼šå¦‚æœnæ•´é™¤2^(n-1)-1ï¼Œåˆ™nå°±æ˜¯ç´ æ•°ã€‚åæ¥æŸä¸ªè‹±å›½å­¦è€…è¿›è¡Œè€ƒè¯åæ‰å‘ç°é‚£æ˜¯å› ä¸ºä»–ä»¬ç¿»è¯‘ä¸­å›½å¤æ–‡æ—¶å‡ºäº†é”™ã€‚1819å¹´æœ‰äººå‘ç°äº†Fermatå°å®šç†é€†å‘½é¢˜çš„ç¬¬ä¸€ä¸ªåä¾‹ï¼šè™½ç„¶2çš„340æ¬¡æ–¹é™¤ä»¥341ä½™1ï¼Œä½†341=11*31ã€‚åæ¥ï¼Œäººä»¬åˆå‘ç°äº†561, 645, 1105ç­‰æ•°éƒ½è¡¨æ˜a=2æ—¶Fermatå°å®šç†çš„é€†å‘½é¢˜ä¸æˆç«‹ã€‚è™½ç„¶è¿™æ ·çš„æ•°ä¸å¤šï¼Œä½†ä¸èƒ½å¿½è§†å®ƒä»¬çš„å­˜åœ¨ã€‚äºæ˜¯ï¼Œäººä»¬æŠŠæ‰€æœ‰èƒ½æ•´é™¤2^(n-1)-1çš„åˆæ•°nå«åšä¼ªç´ æ•°(pseudoprime)ï¼Œæ„æ€å°±æ˜¯å‘Šè¯‰äººä»¬è¿™ä¸ªç´ æ•°æ˜¯å‡çš„ã€‚</p>
<p>ä¸æ»¡è¶³2^(n-1) mod n = 1çš„nä¸€å®šä¸æ˜¯ç´ æ•°ï¼›å¦‚æœæ»¡è¶³çš„è¯åˆ™å¤šåŠæ˜¯ç´ æ•°ã€‚è¿™æ ·ï¼Œä¸€ä¸ªæ¯”è¯•é™¤æ³•æ•ˆç‡æ›´é«˜çš„ç´ æ€§åˆ¤æ–­æ–¹æ³•å‡ºç°äº†ï¼šåˆ¶ä½œä¸€å¼ ä¼ªç´ æ•°è¡¨ï¼Œè®°å½•æŸä¸ªèŒƒå›´å†…çš„æ‰€æœ‰ä¼ªç´ æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰æ»¡è¶³2^(n-1) mod n = 1ä¸”ä¸åœ¨ä¼ªç´ æ•°è¡¨ä¸­çš„nå°±æ˜¯ç´ æ•°ã€‚ä¹‹æ‰€ä»¥è¿™ç§æ–¹æ³•æ›´å¿«ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•å¿«é€Ÿè®¡ç®—2^(n-1) mod n çš„å€¼ï¼Œè¿™åœ¨è®¡ç®—æœºçš„å¸®åŠ©ä¸‹å˜å¾—éå¸¸å®¹æ˜“ï¼›åœ¨è®¡ç®—æœºä¸­ä¹Ÿå¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾æœ‰åºæ•°åˆ—ã€Hashè¡¨å¼€æ•£åˆ—ã€æ„å»ºTrieæ ‘ç­‰æ–¹æ³•ä½¿å¾—æŸ¥æ‰¾ä¼ªç´ æ•°è¡¨æ•ˆç‡æ›´é«˜ã€‚</p>
<p>æœ‰äººè‡ªç„¶ä¼šå…³å¿ƒè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¼ªç´ æ•°çš„ä¸ªæ•°åˆ°åº•æœ‰å¤šå°‘ï¼Ÿæ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘åªè®¡ç®—2^(n-1) mod nçš„å€¼ï¼Œäº‹å…ˆä¸å‡†å¤‡ä¼ªç´ æ•°è¡¨ï¼Œé‚£ä¹ˆç´ æ€§åˆ¤æ–­å‡ºé”™çš„æ¦‚ç‡æœ‰å¤šå°‘ï¼Ÿç ”ç©¶è¿™ä¸ªé—®é¢˜æ˜¯å¾ˆæœ‰ä»·å€¼çš„ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯OIerï¼Œä¸å¯èƒ½èƒŒä¸€ä¸ªé•¿åº¦ä¸Šåƒçš„å¸¸é‡æ•°ç»„å¸¦ä¸Šè€ƒåœºã€‚ç»Ÿè®¡è¡¨æ˜ï¼Œåœ¨å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­å…±æœ‰50847534ä¸ªç´ æ•°ï¼Œè€Œæ»¡è¶³2^(n-1) mod n = 1çš„åˆæ•°næœ‰5597ä¸ªã€‚è¿™æ ·ç®—ä¸‹æ¥ï¼Œç®—æ³•å‡ºé”™çš„å¯èƒ½æ€§çº¦ä¸º0.00011ã€‚è¿™ä¸ªæ¦‚ç‡å¤ªé«˜äº†ï¼Œå¦‚æœæƒ³å…å»å»ºç«‹ä¼ªç´ æ•°è¡¨çš„å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦æ”¹è¿›ç´ æ€§åˆ¤æ–­çš„ç®—æ³•ã€‚  </p>
<p>æœ€ç®€å•çš„æƒ³æ³•å°±æ˜¯ï¼Œæˆ‘ä»¬åˆšæ‰åªè€ƒè™‘äº†a=2çš„æƒ…å†µã€‚å¯¹äºå¼å­a^(n-1) mod nï¼Œå–ä¸åŒçš„aå¯èƒ½å¯¼è‡´ä¸åŒçš„ç»“æœã€‚ä¸€ä¸ªåˆæ•°å¯èƒ½åœ¨a=2æ—¶é€šè¿‡äº†æµ‹è¯•ï¼Œä½†a=3æ—¶çš„è®¡ç®—ç»“æœå´æ’é™¤äº†ç´ æ•°çš„å¯èƒ½ã€‚äºæ˜¯ï¼Œäººä»¬æ‰©å±•äº†ä¼ªç´ æ•°çš„å®šä¹‰ï¼Œç§°æ»¡è¶³a^(n-1) mod n = 1çš„åˆæ•°nå«åšä»¥aä¸ºåº•çš„ä¼ªç´ æ•°(pseudoprime to base a)ã€‚å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­åŒæ—¶ä»¥2å’Œ3ä¸ºåº•çš„ä¼ªç´ æ•°åªæœ‰1272ä¸ªï¼Œè¿™ä¸ªæ•°ç›®ä¸åˆ°åˆšæ‰çš„1/4ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬å¦‚æœåŒæ—¶éªŒè¯a=2å’Œa=3ä¸¤ç§æƒ…å†µï¼Œç®—æ³•å‡ºé”™çš„æ¦‚ç‡é™åˆ°äº†0.000025ã€‚å®¹æ˜“æƒ³åˆ°ï¼Œé€‰æ‹©ç”¨æ¥æµ‹è¯•çš„aè¶Šå¤šï¼Œç®—æ³•è¶Šå‡†ç¡®ã€‚é€šå¸¸æˆ‘ä»¬çš„åšæ³•æ˜¯ï¼Œéšæœºé€‰æ‹©è‹¥å¹²ä¸ªå°äºå¾…æµ‹æ•°çš„æ­£æ•´æ•°ä½œä¸ºåº•æ•°aè¿›è¡Œè‹¥å¹²æ¬¡æµ‹è¯•ï¼Œåªè¦æœ‰ä¸€æ¬¡æ²¡æœ‰é€šè¿‡æµ‹è¯•å°±ç«‹å³æŠŠè¿™ä¸ªæ•°æ‰”å›åˆæ•°çš„ä¸–ç•Œã€‚è¿™å°±æ˜¯Fermatç´ æ€§æµ‹è¯•ã€‚</p>
<p>äººä»¬è‡ªç„¶ä¼šæƒ³ï¼Œå¦‚æœè€ƒè™‘äº†æ‰€æœ‰å°äºnçš„åº•æ•°aï¼Œå‡ºé”™çš„æ¦‚ç‡æ˜¯å¦å°±å¯ä»¥é™åˆ°0å‘¢ï¼Ÿæ²¡æƒ³åˆ°çš„æ˜¯ï¼Œå±…ç„¶å°±æœ‰è¿™æ ·çš„åˆæ•°ï¼Œå®ƒå¯ä»¥é€šè¿‡æ‰€æœ‰açš„æµ‹è¯•ï¼ˆè¿™ä¸ªè¯´æ³•ä¸å‡†ç¡®ï¼Œè¯¦è§æˆ‘åœ¨åœ°æ ¸æ¥¼å±‚çš„å›å¤ï¼‰ã€‚Carmichaelç¬¬ä¸€ä¸ªå‘ç°è¿™æ ·æç«¯çš„ä¼ªç´ æ•°ï¼Œä»–æŠŠå®ƒä»¬ç§°ä½œCarmichaelæ•°ã€‚ä½ ä¸€å®šä¼šä»¥ä¸ºè¿™æ ·çš„æ•°ä¸€å®šå¾ˆå¤§ã€‚é”™ã€‚ç¬¬ä¸€ä¸ªCarmichaelæ•°å°å¾—æƒŠäººï¼Œä»…ä»…æ˜¯ä¸€ä¸ªä¸‰ä½æ•°ï¼Œ561ã€‚å‰10äº¿ä¸ªè‡ªç„¶æ•°ä¸­Carmichaelæ•°ä¹Ÿæœ‰600ä¸ªä¹‹å¤šã€‚Carmichaelæ•°çš„å­˜åœ¨è¯´æ˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»§ç»­åŠ å¼ºç´ æ€§åˆ¤æ–­çš„ç®—æ³•ã€‚</p><footer><strong>Matrix67</strong><cite><a href="http://www.matrix67.com/blog/archives/234" target="_blank" rel="external">æ•°è®ºéƒ¨åˆ†ç¬¬ä¸€èŠ‚ï¼šç´ æ•°ä¸ç´ æ€§æµ‹è¯•</a></cite></footer></blockquote>
<h3 id="Miller-Rabin_ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹">Miller-Rabin ç´ æ€§æµ‹è¯•ä¸äºŒæ¬¡æ¢æµ‹</h3><blockquote>
<p>Miller-Rabinç®—æ³•æ˜¯ç›®å‰ä¸»æµçš„åŸºäºæ¦‚ç‡çš„ç´ æ•°æµ‹è¯•ç®—æ³•ï¼Œåœ¨æ„å»ºå¯†ç å®‰å…¨ä½“ç³»ä¸­å æœ‰é‡è¦çš„åœ°ä½ã€‚é€šè¿‡æ¯”è¾ƒå„ç§ç´ æ•°æµ‹è¯•ç®—æ³•å’Œå¯¹Miller-Rabinç®—æ³•è¿›è¡Œçš„ä»”ç»†ç ”ç©¶ï¼Œè¯æ˜åœ¨è®¡ç®—æœºä¸­æ„å»ºå¯†ç å®‰å…¨ä½“ç³»æ—¶ï¼Œ Miller-Rainç®—æ³•æ˜¯å®Œæˆç´ æ•°æµ‹è¯•çš„æœ€ä½³é€‰æ‹©ã€‚é€šè¿‡å¯¹Miller-Rabin ç®—æ³•åº•å±‚è¿ç®—çš„ä¼˜åŒ–ï¼Œå¯ä»¥å–å¾—è¾ƒä»¥å¾€å®ç°æ›´å¥½çš„æ€§èƒ½ã€‚</p>
</blockquote>
<p>ä»¥ä¸ŠåŸºæœ¬æ²¡ç”¨ã€‚ã€‚ä¸‹é¢æ˜¯è¯¥ç®—æ³•çš„ä¸€äº›å¼•ç†</p>
<blockquote>
<p>äºŒæ¬¡æ¢æµ‹å¼•ç†ï¼šè‹¥pä¸ºå¥‡ç´ æ•°ï¼Œæ–¹ç¨‹x^2â‰¡1(mod p)çš„è§£åªæœ‰Â±1<br>long long èŒƒå›´å†…çš„æ‰€æœ‰æ•´æ•°å‡èƒ½ç”¨å‰9ä¸ªç´ æ•°è¿›è¡Œå‡†ç¡®çš„äºŒæ¬¡æ¢æµ‹</p>
</blockquote>
<h3 id="å®è·µ">å®è·µ</h3><p><a href="http://codevs.cn/problem/1702/" target="_blank" rel="external">codevs1702</a><br>ä¸€ä¸ªæ•°ï¼Œä»–æ˜¯ç´ æ•°ä¹ˆï¼Ÿ<br>è®¾ä»–ä¸ºPæ»¡è¶³(P&lt;=2^63-1)</p>
<p>Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> n=<span class="number">16</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">17</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">ll x;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">            ans+=a; ans%=MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        a=(a+a)%MOD;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;x);</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Yes"</span>); <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="è´¨å› æ•°åˆ†è§£æ³•">è´¨å› æ•°åˆ†è§£æ³•</h2><h3 id="O(sqrt(n))æš´åŠ›åˆ†è§£">O(sqrt(n))æš´åŠ›åˆ†è§£</h3><h3 id="Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•">Pollard-Rhoæ¤­åœ†æ›²çº¿åˆ†è§£æ³•</h3><p>è¿™å‘å¤ªå¤§äº†ï¼Œæœ‰ç‚¹å¡«ä¸åŠ¨è¯¥æ€ä¹ˆåŠã€‚ã€‚ã€‚</p>
<p>ç»è¿‡ä¸€æ™šä¸Šçš„å­¦ä¹ ï¼Œç»ˆäº<del>è¿˜æ˜¯æ²¡æ‡‚</del><br>å…¶å®æ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªå…³äºpollard-rhoç®—æ³•çš„å¾ˆå¥½çš„<a href="http://wenku.baidu.com/link?url=T5oeGiGSqfaurODiXMoErWJS1G8z4M0pnXf24x-gqgxswPyNmxdLdd2UByJPVYAqW-991k5UjJIeABtzQlu1MOGZ4072fQPeBopHiGiPm7m" target="_blank" rel="external">Tutorial</a><br>ç‰µæ‰¯åˆ°åœ†é”¥æ›²çº¿çš„æ–¹é¢<ruby>ä¸è®²äº†<rp> (</rp><rt>tÃ i nÃ¡n liÇo</rt><rp>) </rp></ruby>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œæ·±å…¥ç ”ç©¶ï¼Œç„¶åæˆ‘ä»¬äº†è§£ä¸€ä¸‹pollard-rhoçš„åŸç†ã€‚<br>æ®ç ”ç©¶å¯å¾—(å…·ä½“å¯ä»¥çœ‹é‚£ä¸ªtutorial)ï¼Œå½“æˆ‘ä»¬åœ¨ä¸€å®šèŒƒå›´å†…éšæœºæ•°çš„æ—¶å€™ï¼Œéšè®°ä¸€äº›æ•°å¹¶ä½¿ç”¨å®ƒä»¬çš„å·®å€¼ä½œä¸ºç»“æœæ•ˆæœä¼šè¿œè¿œä¼˜äºæœ´ç´ çš„æšä¸¾æ³•ï¼»ç”Ÿæ—¥æ‚–è®ºï¼½ã€‚<br>åˆ©ç”¨ä»¥ä¸Šæ€§è´¨æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œæ¥éšæœºæšä¸¾ä¸€ä¸ªå¯ä»¥æ•´é™¤å¾…åˆ†è§£å¤§è´¨æ•°çš„æ•°ï¼Œå…·ä½“å¦‚ä¸‹ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥ç”Ÿæˆä¼ªéšæœºæ•°ã€‚<br>æ¢å¥è¯è¯´,æˆ‘ä»¬ä¸æ–­åœ°ä½¿ç”¨å‡½æ•° ğ‘“ æ¥ç”Ÿæˆ(çœ‹ä¸Šå»æˆ–è€…è¯´æ„Ÿè§‰ä¸Šåƒçš„)éšæœºæ•°ã€‚ å¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡½éƒ½èƒ½å¤Ÿè¿™æ ·åš,ä½†æ˜¯æœ‰ä¸€ä¸ªç¥å¥‡çš„å‡½æ•°å¯ä»¥ã€‚å®ƒå°±æ˜¯</p>
<p> $$ f(x)=x^2+c$$</p>
<p>( æˆ‘ä»¬å¯ä»¥è‡ªå·±æŒ‡å®šğ‘,ä¹Ÿå¯ä»¥ç”¨ rand()éšå³å‡½æ•°æ¥ç”Ÿæˆ,è¿™ä¸æ˜¯é‡ç‚¹ )<br>æˆ‘ä»¬ä»ğ‘¥1 = 2 æˆ–è€…å…¶ä»–æ•°å¼€å§‹,è®©ğ‘¥2 = ğ‘“(ğ‘¥1), ğ‘¥3 = ğ‘“(ğ‘¥2), â€¦ â€¦ ç”Ÿæˆè§„åˆ™ä¸ºğ‘¥ğ‘›+1 = ğ‘“(ğ‘¥ğ‘›)</p>
<p>å…·ä½“å®ç°å’Œè¯¦ç»†è¿‡ç¨‹éƒ½åœ¨é‚£ä»½PDFä¸­ï¼»æˆ‘åªæ˜¯ä¸ªæ¬è¿å·¥ã€‚ã€‚ã€‚</p>
<p>è‡ªå·±å†™çš„bzoj3667, ä¸ºä»€ä¹ˆTäº†ã€‚ã€‚ã€‚ä¸æ‡‚ï¼Œä»¥åå†æ”¹å§ã€‚</p>
<p>é”™è¯¯çš„Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">6</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">24251</span>&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=-<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line">ll x;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;y) swap(x,y);</span><br><span class="line">    ll r = x % y;</span><br><span class="line">    <span class="keyword">while</span> (r!=<span class="number">0</span>)&#123;</span><br><span class="line">        ll tmp = r;</span><br><span class="line">        r = y % r;</span><br><span class="line">        x = y;</span><br><span class="line">        y = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll tmp=(a*b-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)a/p*b+<span class="number">1e-8</span>)*p);</span><br><span class="line">    <span class="keyword">return</span> tmp&lt;<span class="number">0</span>?tmp+p:tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MR</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=NN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (mul(x,x,y)+rand()+<span class="number">12894</span>)%y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Prho</span><span class="params">(ll N)</span></span>&#123;</span><br><span class="line">    ll p=<span class="number">1</span>,t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (MR(N)==<span class="number">1</span>) <span class="keyword">return</span> N;</span><br><span class="line">    ll a=<span class="number">2</span>,b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        a=f(a,N);</span><br><span class="line">        b=f(f(b,N),N);</span><br><span class="line">        <span class="keyword">if</span> (a==b) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (a&gt;b) t=a-b; <span class="keyword">else</span> t=b-a;</span><br><span class="line">        p=gcd(t,N);</span><br><span class="line">        <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">return</span> max(Prho(p),Prho(N/p)); <span class="keyword">else</span> <span class="keyword">return</span> N;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)&#123;</span><br><span class="line">        x=read();</span><br><span class="line">        <span class="keyword">if</span> (x==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"1"</span>); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Prime"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans=Prho(x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‘ç°æˆ‘åœ¨å†™f(x)çš„æ—¶å€™æ¯æ¬¡éƒ½rand()äº†ï¼Œè¿™æ˜¯æç«¯é”™è¯¯çš„ã€‚ã€‚ã€‚<br>è€Œä¸”æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œå¦‚æœåœ¨miller-rabinç®—æ³•ä¸­ç”¨2,3,7,61,24251,é‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªååˆ†å‰å®³çš„å«åš46 856 248 255 981çš„è¶…å¼ºä¼ªç´ æ•°çš„å­˜åœ¨ï¼ŒOTL</p>
<p>ACçš„Code<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> ll p[<span class="number">6</span>]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">61</span>,<span class="number">24251</span>&#125;;</span><br><span class="line">ll ran;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function">ll <span class="title">read</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=-<span class="number">1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line">ll x;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;y) swap(x,y);</span><br><span class="line">    ll r = x % y;</span><br><span class="line">    <span class="keyword">while</span> (r!=<span class="number">0</span>)&#123;</span><br><span class="line">        ll tmp = r;</span><br><span class="line">        r = y % r;</span><br><span class="line">        x = y;</span><br><span class="line">        y = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ll tmp=(a*b-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)a/p*b+<span class="number">1e-8</span>)*p);</span><br><span class="line">    <span class="keyword">return</span> tmp&lt;<span class="number">0</span>?tmp+p:tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll a,ll b,ll MOD)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>)==<span class="number">1</span>) ans=mul(ans,a,MOD);</span><br><span class="line">        a=mul(a,a,MOD);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Isprime</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ((b==<span class="number">1</span>)||((b &amp; <span class="number">1</span>)==<span class="number">0</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll t=b-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((t &amp; <span class="number">1</span>)==<span class="number">0</span>) t&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    ll tmp=power(a,t,b);</span><br><span class="line">    <span class="keyword">while</span> ((t!=b-<span class="number">1</span>)&amp;&amp;(tmp!=<span class="number">1</span>)&amp;&amp;(tmp!=b-<span class="number">1</span>))&#123;</span><br><span class="line">        tmp=mul(tmp,tmp,b);</span><br><span class="line">        t&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((tmp==b-<span class="number">1</span>)||((t &amp; <span class="number">1</span>)==<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MR</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">46856248255981</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=NN; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i]==x)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flag=<span class="function">flag &amp; <span class="title">Isprime</span><span class="params">(p[i],x)</span></span>;</span><br><span class="line">            <span class="keyword">if</span> (flag==<span class="number">0</span>) &#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x,ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (mul(x,x,y)+ran+<span class="number">12894</span>)%y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Prho</span><span class="params">(ll N)</span></span>&#123;</span><br><span class="line">    ll p=<span class="number">1</span>,t=<span class="number">0</span>;</span><br><span class="line">    ll a=<span class="number">2</span>,b=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        a=f(a,N);</span><br><span class="line">        b=f(f(b,N),N);</span><br><span class="line">        <span class="keyword">if</span> (a==b) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (a&gt;b) t=a-b; <span class="keyword">else</span> t=b-a;</span><br><span class="line">        p=gcd(t,N);</span><br><span class="line">        <span class="keyword">if</span> (p&gt;<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">4</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    ll p=x;</span><br><span class="line">    <span class="keyword">while</span> (p==x||p==<span class="number">1</span>)&#123;</span><br><span class="line">        ran=rand()+<span class="number">19990128</span>; ran%=x;</span><br><span class="line">        p=Prho(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max(work(p),work(x/p));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)&#123;</span><br><span class="line">        x=read();</span><br><span class="line">        <span class="keyword">if</span> (x==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"1"</span>); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (MR(x)==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"Prime"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans=work(x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>data</strong><br><a href="http://pan.baidu.com/s/1o6064WU" target="_blank" rel="external">http://pan.baidu.com/s/1o6064WU</a></p>
    
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.fractal128.tk/2015/09/27/number-theory2/" data-id="cife7luwx001emj4532km5wtc" class="article-share-link">Share</a>
      
        <a href="http://blog.fractal128.tk/2015/09/27/number-theory2/#disqus_thread" class="article-comment-link">Comments</a>
      
      <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ•°è®º/">æ•°è®º</a></li></ul>
    </footer>
  </div>
  
    <nav id="article-nav">
  
    <a href="/2015/09/30/201509/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          æ‘‡æ›³çš„ä¹æœˆã€‚
        
      </div>
    </a>
  
  
    <a href="/2015/09/27/vijos1382/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Vijos1382ï¼šå¯»æ‰¾ä¸»äºº</div>
    </a>
  
</nav>
  
</article>


<section id="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'fractal128sblog';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</section></section>
      
        <aside id="sidebar">

  
    <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/05/bzoj1595/" class="thumbnail">
  
    <span style="background-image:url(http://7xl5lt.com1.z0.glb.clouddn.com/nail06.jpg)" alt="BZOJ1595: [Usaco2008 Jan]äººå·¥æ¹–" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ°´é¢˜/">æ°´é¢˜</a></p>
              <p class="item-title"><a href="/2015/10/05/bzoj1595/" class="title">BZOJ1595: [Usaco2008 Jan]äººå·¥æ¹–</a></p>
              <p class="item-date"><time datetime="2015-10-05T11:14:48.000Z" itemprop="datePublished">2015-10-05</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/05/bzoj3043/" class="thumbnail">
  
    <span style="background-image:url(http://7xl5lt.com1.z0.glb.clouddn.com/nail02.jpg)" alt="BZOJ3043: IncDec Sequence" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ°´é¢˜/">æ°´é¢˜</a></p>
              <p class="item-title"><a href="/2015/10/05/bzoj3043/" class="title">BZOJ3043: IncDec Sequence</a></p>
              <p class="item-date"><time datetime="2015-10-04T19:30:24.000Z" itemprop="datePublished">2015-10-05</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/04/mock_noip2015/" class="thumbnail">
  
    <span style="background-image:url(http://7xl5lt.com1.z0.glb.clouddn.com/banner17.jpg)" alt="NOIP2015æ¨¡æ‹Ÿé¢˜é›†" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ¯”èµ›/">æ¯”èµ›</a></p>
              <p class="item-title"><a href="/2015/10/04/mock_noip2015/" class="title">NOIP2015æ¨¡æ‹Ÿé¢˜é›†</a></p>
              <p class="item-date"><time datetime="2015-10-04T14:39:49.000Z" itemprop="datePublished">2015-10-04</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/03/bcRound58/" class="thumbnail">
  
    <span style="background-image:url(http://7xl5lt.com1.z0.glb.clouddn.com/banner12.jpg)" alt="BestCoder Round #58 (div.2)" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ¯”èµ›/">æ¯”èµ›</a></p>
              <p class="item-title"><a href="/2015/10/03/bcRound58/" class="title">BestCoder Round #58 (div.2)</a></p>
              <p class="item-date"><time datetime="2015-10-03T14:42:58.000Z" itemprop="datePublished">2015-10-03</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2015/10/02/bzoj2142/" class="thumbnail">
  
    <span style="background-image:url(http://7xl5lt.com1.z0.glb.clouddn.com/nail15.jpg)" alt="BZOJ2142: ç¤¼ç‰©" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/OI/">OI</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/OI/æ•°è®º/">æ•°è®º</a></p>
              <p class="item-title"><a href="/2015/10/02/bzoj2142/" class="title">BZOJ2142: ç¤¼ç‰©</a></p>
              <p class="item-date"><time datetime="2015-10-02T15:51:28.000Z" itemprop="datePublished">2015-10-02</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>
  
    <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/OI/">OI</a><span class="category-list-count">24</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/OI/äºŒåˆ†å›¾/">äºŒåˆ†å›¾</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/åŠ¨æ€è§„åˆ’/">åŠ¨æ€è§„åˆ’</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æœç´¢/">æœç´¢</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æ•°æ®ç»“æ„/">æ•°æ®ç»“æ„</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æ•°è®º/">æ•°è®º</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æœ€å°è¡¨ç¤ºæ³•/">æœ€å°è¡¨ç¤ºæ³•</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æ¯”èµ›/">æ¯”èµ›</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/æ°´é¢˜/">æ°´é¢˜</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/ç½‘ç»œæµ/">ç½‘ç»œæµ</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OI/ç¾¤è®º/">ç¾¤è®º</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/éšè®°/">éšè®°</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>
  
    <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/BZOJ/" style="font-size: 20px">BZOJ</a> <a href="/tags/BestCoder/" style="font-size: 10px">BestCoder</a> <a href="/tags/HNOI/" style="font-size: 10px">HNOI</a> <a href="/tags/NOIP2015/" style="font-size: 10px">NOIP2015</a> <a href="/tags/SDOI/" style="font-size: 12.5px">SDOI</a> <a href="/tags/USACO/" style="font-size: 10px">USACO</a> <a href="/tags/ZJOI/" style="font-size: 10px">ZJOI</a> <a href="/tags/burnsideå¼•ç†/" style="font-size: 10px">burnsideå¼•ç†</a> <a href="/tags/ctsc/" style="font-size: 10px">ctsc</a> <a href="/tags/dilworthå®šç†/" style="font-size: 10px">dilworthå®šç†</a> <a href="/tags/polya/" style="font-size: 10px">pÃ³lya</a> <a href="/tags/test/" style="font-size: 10px">test</a> <a href="/tags/uva/" style="font-size: 10px">uva</a> <a href="/tags/vijos/" style="font-size: 10px">vijos</a> <a href="/tags/ä¸€èˆ¬é€’æ¨/" style="font-size: 10px">ä¸€èˆ¬é€’æ¨</a> <a href="/tags/ä¸œé‡åœ­å¾/" style="font-size: 10px">ä¸œé‡åœ­å¾</a> <a href="/tags/ä¸­å›½å‰©ä½™å®šç†/" style="font-size: 10px">ä¸­å›½å‰©ä½™å®šç†</a> <a href="/tags/ä¹˜æ³•é€†å…ƒ/" style="font-size: 10px">ä¹˜æ³•é€†å…ƒ</a> <a href="/tags/äºŒåˆ†å›¾/" style="font-size: 12.5px">äºŒåˆ†å›¾</a> <a href="/tags/åŠ¨æ€è§„åˆ’/" style="font-size: 10px">åŠ¨æ€è§„åˆ’</a> <a href="/tags/æœç´¢/" style="font-size: 10px">æœç´¢</a> <a href="/tags/æ•°åˆ—å·®åˆ†/" style="font-size: 10px">æ•°åˆ—å·®åˆ†</a> <a href="/tags/æ•°æ®ç»“æ„/" style="font-size: 12.5px">æ•°æ®ç»“æ„</a> <a href="/tags/æ•°è®º/" style="font-size: 17.5px">æ•°è®º</a> <a href="/tags/æœ€å¤§æµ/" style="font-size: 12.5px">æœ€å¤§æµ</a> <a href="/tags/æœ€å°å‰²/" style="font-size: 12.5px">æœ€å°å‰²</a> <a href="/tags/æœ€å°è¡¨ç¤ºæ³•/" style="font-size: 12.5px">æœ€å°è¡¨ç¤ºæ³•</a> <a href="/tags/æœ€çŸ­è·¯/" style="font-size: 10px">æœ€çŸ­è·¯</a> <a href="/tags/æ¨¡æ‹Ÿ/" style="font-size: 10px">æ¨¡æ‹Ÿ</a> <a href="/tags/ç½‘ç»œæµ/" style="font-size: 15px">ç½‘ç»œæµ</a> <a href="/tags/é¢å£åçœ/" style="font-size: 15px">é¢å£åçœ</a>
    </div>
  </div>
  
    <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>
  
    <div class="widget-wrap widget-list">
    <h3 class="widget-title">links</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://hexo.io/">Hexo</a>
          </li>
        
          <li>
            <a href="http://i301void.gitcafe.io">i301void</a>
          </li>
        
          <li>
            <a href="http://blog.acmicpc.info">FlowForACMers</a>
          </li>
        
          <li>
            <a href="http://patina27.aliapp.com/">Patina27</a>
          </li>
        
      </ul>
    </div>
  </div>
  

  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 fractal128 <br> 
      
      <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
		</script>
		<span id="busuanzi_container_site_uv">
  		æ‚¨æ˜¯æœ¬ç«™ç¬¬<span id="busuanzi_value_site_uv"></span>ä½è®¿å®¢
		</span><br>

      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    <script>
  var disqus_shortname = 'fractal128';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>





  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
messageStyle: "none"
    }); 
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </div>
</body>
